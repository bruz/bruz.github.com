<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">// Project:   SproutCore - JavaScript Application Framework</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="COMM">// Copyright: ©2006-2010 Sprout Systems, Inc. and contributors.</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="COMM">//            Portions ©2008-2010 Apple Inc. All rights reserved.</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="COMM">// License:   Licensed under MIT license (see license.js)</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  7</span> 
<span class='line'>  8</span> </span><span class="COMM">/**
<span class='line'>  9</span>   This platform object allows you to conditionally support certain HTML5
<span class='line'> 10</span>   features.
<span class='line'> 11</span> 
<span class='line'> 12</span>   Rather than relying on the user agent, it detects whether the given elements
<span class='line'> 13</span>   and events are supported by the browser, allowing you to create much more
<span class='line'> 14</span>   robust apps.
<span class='line'> 15</span> */</span><span class="WHIT">
<span class='line'> 16</span> 
<span class='line'> 17</span> </span><span class="NAME">SC.platform</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 18</span>   </span><span class="COMM">/**
<span class='line'> 19</span>     YES if the current device supports touch events, NO otherwise.
<span class='line'> 20</span> 
<span class='line'> 21</span>     You can simulate touch events in environments that don't support them by
<span class='line'> 22</span>     calling SC.platform.simulateTouchEvents() from your browser's console.
<span class='line'> 23</span> 
<span class='line'> 24</span>     @property {Boolean}
<span class='line'> 25</span>   */</span><span class="WHIT">
<span class='line'> 26</span>   </span><span class="NAME">touch</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'createTouch'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 27</span>   
<span class='line'> 28</span>   </span><span class="NAME">bounceOnScroll</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/iPhone|iPad|iPod/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">navigator.platform</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 29</span>   </span><span class="NAME">pinchToZoom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/iPhone|iPad|iPod/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">navigator.platform</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 30</span> 
<span class='line'> 31</span>   </span><span class="COMM">/**
<span class='line'> 32</span>     A hash that contains properties that indicate support for new HTML5
<span class='line'> 33</span>     input attributes.
<span class='line'> 34</span> 
<span class='line'> 35</span>     For example, to test to see if the placeholder attribute is supported,
<span class='line'> 36</span>     you would verify that SC.platform.input.placeholder is YES.
<span class='line'> 37</span>   */</span><span class="WHIT">
<span class='line'> 38</span>   </span><span class="NAME">input</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 39</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 40</span>         </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attributes.length</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 41</span>         </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'input'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 42</span>         </span><span class="NAME">attr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 43</span> 
<span class='line'> 44</span>     </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 45</span>       </span><span class="NAME">attr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 46</span> 
<span class='line'> 47</span>       </span><span class="NAME">ret</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 48</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 49</span> 
<span class='line'> 50</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 51</span>   </span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="STRN">'autocomplete readonly list size required multiple maxlength '</span><span class="WHIT">
<span class='line'> 52</span>     </span><span class="PUNC">+</span><span class="STRN">'pattern min max step placeholder'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">w</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 53</span> 
<span class='line'> 54</span>   </span><span class="COMM">/**
<span class='line'> 55</span>     YES if the application is currently running as a standalone application.
<span class='line'> 56</span> 
<span class='line'> 57</span>     For example, if the user has saved your web application to their home
<span class='line'> 58</span>     screen on an iPhone OS-based device, this property will be true.
<span class='line'> 59</span>     @property {Boolean}
<span class='line'> 60</span>   */</span><span class="WHIT">
<span class='line'> 61</span>   </span><span class="NAME">standalone</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">navigator.standalone</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 62</span> 
<span class='line'> 63</span>   </span><span class="COMM">/**
<span class='line'> 64</span>     Prefix for browser specific CSS attributes. Calculated later.
<span class='line'> 65</span>   */</span><span class="WHIT">
<span class='line'> 66</span>   </span><span class="NAME">cssPrefix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 67</span> 
<span class='line'> 68</span>   </span><span class="COMM">/**
<span class='line'> 69</span>     Prefix for browsew specific CSS attributes when used in the DOM. Calculated later.
<span class='line'> 70</span>   */</span><span class="WHIT">
<span class='line'> 71</span>   </span><span class="NAME">domCSSPrefix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 72</span> 
<span class='line'> 73</span>   </span><span class="COMM">/**
<span class='line'> 74</span>     Call this method to swap out the default mouse handlers with proxy methods
<span class='line'> 75</span>     that will translate mouse events to touch events.
<span class='line'> 76</span> 
<span class='line'> 77</span>     This is useful if you are debugging touch functionality on the desktop.
<span class='line'> 78</span>   */</span><span class="WHIT">
<span class='line'> 79</span>   </span><span class="NAME">simulateTouchEvents</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 80</span>     </span><span class="COMM">// Touch events are supported natively, no need for this.</span><span class="WHIT">
<span class='line'> 81</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.touch</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 82</span>       </span><span class="COMM">//@ if (debug)</span><span class="WHIT">
<span class='line'> 83</span>       </span><span class="NAME">SC.Logger.info</span><span class="PUNC">(</span><span class="STRN">"Can't simulate touch events in an environment that supports them."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 84</span>       </span><span class="COMM">//@ endif</span><span class="WHIT">
<span class='line'> 85</span>       </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 87</span> 
<span class='line'> 88</span>     </span><span class="COMM">// Tell the app that we now "speak" touch</span><span class="WHIT">
<span class='line'> 89</span>     </span><span class="NAME">SC.platform.touch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 90</span> 
<span class='line'> 91</span>     </span><span class="COMM">// CSS selectors may depend on the touch class name being present</span><span class="WHIT">
<span class='line'> 92</span>     </span><span class="NAME">document.body.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.body.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' touch'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 93</span> 
<span class='line'> 94</span>     </span><span class="COMM">// Initialize a counter, which we will use to generate unique ids for each</span><span class="WHIT">
<span class='line'> 95</span>     </span><span class="COMM">// fake touch.</span><span class="WHIT">
<span class='line'> 96</span>     </span><span class="NAME">this._simtouch_counter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 97</span> 
<span class='line'> 98</span>     </span><span class="COMM">// Remove events that don't exist in touch environments</span><span class="WHIT">
<span class='line'> 99</span>     </span><span class="NAME">this.removeEvents</span><span class="PUNC">(</span><span class="STRN">'click dblclick mouseout mouseover mousewheel'</span><span class="PUNC">.</span><span class="NAME">w</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>100</span> 
<span class='line'>101</span>     </span><span class="COMM">// Replace mouse events with our translation methods</span><span class="WHIT">
<span class='line'>102</span>     </span><span class="NAME">this.replaceEvent</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._simtouch_mousemove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>103</span>     </span><span class="NAME">this.replaceEvent</span><span class="PUNC">(</span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._simtouch_mousedown</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>104</span>     </span><span class="NAME">this.replaceEvent</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._simtouch_mouseup</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>105</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>106</span> 
<span class='line'>107</span>   </span><span class="COMM">/** @private
<span class='line'>108</span>     Removes event listeners from the document.
<span class='line'>109</span> 
<span class='line'>110</span>     @param {Array} events Array of strings representing the events to remove
<span class='line'>111</span>   */</span><span class="WHIT">
<span class='line'>112</span>   </span><span class="NAME">removeEvents</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">events</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>113</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span>     </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>115</span>       </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>116</span>       </span><span class="NAME">SC.Event.remove</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>117</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>118</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>119</span> 
<span class='line'>120</span>   </span><span class="COMM">/** @private
<span class='line'>121</span>     Replaces an event listener with another.
<span class='line'>122</span> 
<span class='line'>123</span>     @param {String} evt The event to replace
<span class='line'>124</span>     @param {Function} replacement The method that should be called instead
<span class='line'>125</span>   */</span><span class="WHIT">
<span class='line'>126</span>   </span><span class="NAME">replaceEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">replacement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>127</span>     </span><span class="NAME">SC.Event.remove</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder</span><span class="PUNC">[</span><span class="NAME">evt</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>128</span>     </span><span class="NAME">SC.Event.add</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">replacement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>129</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>130</span> 
<span class='line'>131</span>   </span><span class="COMM">/** @private
<span class='line'>132</span>     When simulating touch events, this method is called when mousemove events
<span class='line'>133</span>     are received.
<span class='line'>134</span>   */</span><span class="WHIT">
<span class='line'>135</span>   </span><span class="NAME">_simtouch_mousemove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>136</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._mousedown</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>137</span> 
<span class='line'>138</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">manufacturedEvt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.manufactureTouchEvent</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'touchmove'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>139</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder.touchmove</span><span class="PUNC">(</span><span class="NAME">manufacturedEvt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>140</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>141</span> 
<span class='line'>142</span>   </span><span class="COMM">/** @private
<span class='line'>143</span>     When simulating touch events, this method is called when mousedown events
<span class='line'>144</span>     are received.
<span class='line'>145</span>   */</span><span class="WHIT">
<span class='line'>146</span>   </span><span class="NAME">_simtouch_mousedown</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>147</span>     </span><span class="NAME">this._mousedown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>148</span> 
<span class='line'>149</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">manufacturedEvt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.manufactureTouchEvent</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'touchstart'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>150</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder.touchstart</span><span class="PUNC">(</span><span class="NAME">manufacturedEvt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>151</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>152</span> 
<span class='line'>153</span>   </span><span class="COMM">/** @private
<span class='line'>154</span>     When simulating touch events, this method is called when mouseup events
<span class='line'>155</span>     are received.
<span class='line'>156</span>   */</span><span class="WHIT">
<span class='line'>157</span>   </span><span class="NAME">_simtouch_mouseup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>158</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">manufacturedEvt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.manufactureTouchEvent</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'touchend'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>159</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.RootResponder.responder.touchend</span><span class="PUNC">(</span><span class="NAME">manufacturedEvt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>160</span> 
<span class='line'>161</span>     </span><span class="NAME">this._mousedown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>162</span>     </span><span class="NAME">this._simtouch_counter</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>163</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>164</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>165</span> 
<span class='line'>166</span>   </span><span class="COMM">/** @private
<span class='line'>167</span>     Converts a mouse-style event to a touch-style event.
<span class='line'>168</span> 
<span class='line'>169</span>     Note that this method edits the passed event in place, and returns
<span class='line'>170</span>     that same instance instead of a new, modified version.
<span class='line'>171</span> 
<span class='line'>172</span>     @param {Event} evt the mouse event to modify
<span class='line'>173</span>     @param {String} type the type of event (e.g., touchstart)
<span class='line'>174</span>     @returns {Event} the mouse event with an added changedTouches array
<span class='line'>175</span>   */</span><span class="WHIT">
<span class='line'>176</span>   </span><span class="NAME">manufactureTouchEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>177</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">touchIdentifier</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._simtouch_counter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>178</span> 
<span class='line'>179</span>     </span><span class="NAME">touch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>180</span>       </span><span class="NAME">type</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>181</span>       </span><span class="NAME">target</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.target</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>182</span>       </span><span class="NAME">identifier</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">touchIdentifier</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>183</span>       </span><span class="NAME">pageX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.pageX</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>184</span>       </span><span class="NAME">pageY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.pageY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>185</span>       </span><span class="NAME">screenX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.screenX</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>186</span>       </span><span class="NAME">screenY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.screenY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>187</span>       </span><span class="NAME">clientX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.clientX</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>188</span>       </span><span class="NAME">clientY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">evt.clientY</span><span class="WHIT">
<span class='line'>189</span>     </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>190</span> 
<span class='line'>191</span>     </span><span class="NAME">evt.changedTouches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">evt.touches</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT"> </span><span class="NAME">touch</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>192</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>193</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>194</span> 
<span class='line'>195</span>   </span><span class="COMM">/**
<span class='line'>196</span>     Whether the browser supports CSS transitions. Calculated later.
<span class='line'>197</span>   */</span><span class="WHIT">
<span class='line'>198</span>   </span><span class="NAME">supportsCSSTransitions</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>199</span> 
<span class='line'>200</span>   </span><span class="COMM">/**
<span class='line'>201</span>     Whether the browser supports 2D CSS transforms. Calculated later.
<span class='line'>202</span>   */</span><span class="WHIT">
<span class='line'>203</span>   </span><span class="NAME">supportsCSSTransforms</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>204</span> 
<span class='line'>205</span>   </span><span class="COMM">/**
<span class='line'>206</span>     Whether the browser understands 3D CSS transforms.
<span class='line'>207</span>     This does not guarantee that the browser properly handles them.
<span class='line'>208</span>     Calculated later.
<span class='line'>209</span>   */</span><span class="WHIT">
<span class='line'>210</span>   </span><span class="NAME">understandsCSS3DTransforms</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>211</span> 
<span class='line'>212</span>   </span><span class="COMM">/**
<span class='line'>213</span>     Whether the browser can properly handle 3D CSS transforms. Calculated later.
<span class='line'>214</span>   */</span><span class="WHIT">
<span class='line'>215</span>   </span><span class="NAME">supportsCSS3DTransforms</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>216</span>   
<span class='line'>217</span>   </span><span class="COMM">/**
<span class='line'>218</span>     Whether the browser can handle accelerated layers. While supports3DTransforms tells us if they will
<span class='line'>219</span>     work in principle, sometimes accelerated layers interfere with things like getBoundingClientRect.
<span class='line'>220</span>     Then everything breaks.
<span class='line'>221</span>   */</span><span class="WHIT">
<span class='line'>222</span>   </span><span class="NAME">supportsAcceleratedLayers</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>223</span>   
<span class='line'>224</span>   </span><span class="COMM">/**
<span class='line'>225</span>     Wether the browser supports the hashchange event.
<span class='line'>226</span>   */</span><span class="WHIT">
<span class='line'>227</span>   </span><span class="NAME">supportsHashChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>228</span>     </span><span class="COMM">// Code copied from Modernizr which copied code from YUI (MIT licenses)</span><span class="WHIT">
<span class='line'>229</span>     </span><span class="COMM">// documentMode logic from YUI to filter out IE8 Compat Mode which false positives</span><span class="WHIT">
<span class='line'>230</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'onhashchange'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">document.documentMode</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">document.documentMode</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">7</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>231</span>   </span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>232</span> 
<span class='line'>233</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>234</span> 
<span class='line'>235</span> </span><span class="COMM">/* Calculate CSS Prefixes */</span><span class="WHIT">
<span class='line'>236</span> 
<span class='line'>237</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>238</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>239</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="REGX">/webkit/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">userAgent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>240</span>     </span><span class="NAME">SC.platform.cssPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'webkit'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>241</span>     </span><span class="NAME">SC.platform.domCSSPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Webkit'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>242</span>   </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="REGX">/opera/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>243</span>     </span><span class="NAME">SC.platform.cssPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'opera'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>244</span>     </span><span class="NAME">SC.platform.domCSSPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'O'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>245</span>   </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="REGX">/msie/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="REGX">/opera/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>246</span>     </span><span class="NAME">SC.platform.cssPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'ms'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>247</span>     </span><span class="NAME">SC.platform.domCSSPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'ms'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>248</span>   </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="REGX">/mozilla/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="REGX">/(compatible|webkit)/</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">userAgent</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>249</span>     </span><span class="NAME">SC.platform.cssPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'moz'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>250</span>     </span><span class="NAME">SC.platform.domCSSPrefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Moz'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>252</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>253</span> 
<span class='line'>254</span> </span><span class="COMM">/* Calculate transform support */</span><span class="WHIT">
<span class='line'>255</span> 
<span class='line'>256</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>257</span>   </span><span class="COMM">// a test element</span><span class="WHIT">
<span class='line'>258</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>259</span> 
<span class='line'>260</span>   </span><span class="COMM">// the css and javascript to test</span><span class="WHIT">
<span class='line'>261</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">css_browsers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"-moz-"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"-moz-"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"-o-"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"-ms-"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"-webkit-"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>262</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">test_browsers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"moz"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"Moz"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"o"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ms"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"webkit"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>263</span> 
<span class='line'>264</span>   </span><span class="COMM">// prepare css</span><span class="WHIT">
<span class='line'>265</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>266</span>   </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">css_browsers.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>267</span>     </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">css_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"transition:all 1s linear;"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>268</span>     </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">css_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"transform: translate(1px, 1px);"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span>     </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">css_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"perspective: 500px;"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>271</span> 
<span class='line'>272</span>   </span><span class="COMM">// set css text</span><span class="WHIT">
<span class='line'>273</span>   </span><span class="NAME">el.style.cssText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">css</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> 
<span class='line'>275</span>   </span><span class="COMM">// test</span><span class="WHIT">
<span class='line'>276</span>   </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">test_browsers.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>277</span>   </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>278</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.style</span><span class="PUNC">[</span><span class="NAME">test_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"TransitionProperty"</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.platform.supportsCSSTransitions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>279</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.style</span><span class="PUNC">[</span><span class="NAME">test_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"Transform"</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.platform.supportsCSSTransforms</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>280</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">el.style</span><span class="PUNC">[</span><span class="NAME">test_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"Perspective"</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">el.style</span><span class="PUNC">[</span><span class="NAME">test_browsers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"PerspectiveProperty"</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>281</span>       </span><span class="NAME">SC.platform.understandsCSS3DTransforms</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>282</span>       </span><span class="NAME">SC.platform.supportsCSS3DTransforms</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>283</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>284</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>285</span> 
<span class='line'>286</span>   </span><span class="COMM">// unfortunately, we need a bit more to know FOR SURE that 3D is allowed</span><span class="WHIT">
<span class='line'>287</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">window.media</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">window.media.matchMedium</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>288</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.media.matchMedium</span><span class="PUNC">(</span><span class="STRN">'(-webkit-transform-3d)'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.platform.supportsCSS3DTransforms</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>289</span>   </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.styleMedia</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">window.styleMedia.matchMedium</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>290</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.styleMedia.matchMedium</span><span class="PUNC">(</span><span class="STRN">'(-webkit-transform-3d)'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.platform.supportsCSS3DTransforms</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">    
<span class='line'>291</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>292</span>   
<span class='line'>293</span>   </span><span class="COMM">// Unfortunately, this has to be manual, as I can't think of a good way to test it</span><span class="WHIT">
<span class='line'>294</span>   </span><span class="COMM">// webkit-only for now.</span><span class="WHIT">
<span class='line'>295</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.platform.supportsCSSTransforms</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.platform.cssPrefix</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"webkit"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>296</span>     </span><span class="NAME">SC.platform.supportsAcceleratedLayers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>298</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span></pre></body></html>
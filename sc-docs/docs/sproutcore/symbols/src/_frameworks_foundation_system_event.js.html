<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">// Project:   SproutCore - JavaScript Application Framework</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="COMM">// Copyright: ©2006-2009 Sprout Systems, Inc. and contributors.</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="COMM">//            Portions ©2008-2009 Apple Inc. All rights reserved.</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="COMM">// License:   Licensed under MIT license (see license.js)</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  7</span> 
<span class='line'>  8</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/core_query'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  9</span> 
<span class='line'> 10</span> </span><span class="COMM">/**
<span class='line'> 11</span>   The event class provides a simple cross-platform library for capturing and
<span class='line'> 12</span>   delivering events on DOM elements and other objects.  While this library
<span class='line'> 13</span>   is based on code from both jQuery and Prototype.js, it includes a number of
<span class='line'> 14</span>   additional features including support for handler objects and event 
<span class='line'> 15</span>   delegation.
<span class='line'> 16</span> 
<span class='line'> 17</span>   Since native events are implemented very unevenly across browsers,
<span class='line'> 18</span>   SproutCore will convert all native events into a standardized instance of
<span class='line'> 19</span>   this special event class.  
<span class='line'> 20</span>   
<span class='line'> 21</span>   SproutCore events implement the standard W3C event API as well as some 
<span class='line'> 22</span>   additional helper methods.
<span class='line'> 23</span> 
<span class='line'> 24</span>   @constructor
<span class='line'> 25</span>   @param {Event} originalEvent
<span class='line'> 26</span>   @returns {SC.Event} event instance
<span class='line'> 27</span>   
<span class='line'> 28</span>   @since SproutCore 1.0
<span class='line'> 29</span> */</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="NAME">SC.Event</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">originalEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'> 31</span> 
<span class='line'> 32</span>   </span><span class="COMM">// copy properties from original event, if passed in.</span><span class="WHIT">
<span class='line'> 33</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">originalEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 34</span>     </span><span class="NAME">this.originalEvent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalEvent</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 35</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">props</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event._props</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">props.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 36</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 37</span>       </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">props</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 38</span>       </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalEvent</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 39</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 40</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 41</span> 
<span class='line'> 42</span>   </span><span class="COMM">// Fix timeStamp</span><span class="WHIT">
<span class='line'> 43</span>   </span><span class="NAME">this.timeStamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.timeStamp</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">Date.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 44</span> 
<span class='line'> 45</span>   </span><span class="COMM">// Fix target property, if necessary</span><span class="WHIT">
<span class='line'> 46</span>   </span><span class="COMM">// Fixes #1925 where srcElement might not be defined either</span><span class="WHIT">
<span class='line'> 47</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.srcElement</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'> 48</span> 
<span class='line'> 49</span>   </span><span class="COMM">// check if target is a textnode (safari)</span><span class="WHIT">
<span class='line'> 50</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.target.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.target.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 51</span> 
<span class='line'> 52</span>   </span><span class="COMM">// Add relatedTarget, if necessary</span><span class="WHIT">
<span class='line'> 53</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.relatedTarget</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.fromElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 54</span>     </span><span class="NAME">this.relatedTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.fromElement</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.toElement</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.fromElement</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 55</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 56</span> 
<span class='line'> 57</span>   </span><span class="COMM">// Calculate pageX/Y if missing and clientX/Y available</span><span class="WHIT">
<span class='line'> 58</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">this.pageX</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">this.clientX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 59</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">doc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.documentElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 60</span>     </span><span class="NAME">this.pageX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.clientX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">doc</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">doc.scrollLeft</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">body.scrollLeft</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">doc.clientLeft</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 61</span>     </span><span class="NAME">this.pageY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.clientY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">doc</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">doc.scrollTop</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">body.scrollTop</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">doc.clientTop</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 62</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 63</span> 
<span class='line'> 64</span>   </span><span class="COMM">// Add which for key events</span><span class="WHIT">
<span class='line'> 65</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.which</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.charCode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">originalEvent.charCode</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.charCode</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.keyCode</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 66</span>     </span><span class="NAME">this.which</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.charCode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.keyCode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 67</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 68</span> 
<span class='line'> 69</span>   </span><span class="COMM">// Add metaKey to non-Mac browsers (use ctrl for PC's and Meta for Macs)</span><span class="WHIT">
<span class='line'> 70</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.metaKey</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.ctrlKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.metaKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctrlKey</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> 
<span class='line'> 72</span>   </span><span class="COMM">// Add which for click: 1 == left; 2 == middle; 3 == right</span><span class="WHIT">
<span class='line'> 73</span>   </span><span class="COMM">// Note: button is not normalized, so don't use it</span><span class="WHIT">
<span class='line'> 74</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.which</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.button</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 75</span>     </span><span class="NAME">this.which</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.button</span><span class="WHIT"> </span><span class="PUNC">&</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.button</span><span class="WHIT"> </span><span class="PUNC">&</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.button</span><span class="WHIT"> </span><span class="PUNC">&</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 76</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 77</span>   
<span class='line'> 78</span>   </span><span class="COMM">// Normalize wheel delta values for mousewheel events</span><span class="WHIT">
<span class='line'> 79</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'mousewheel'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'DOMMouseScroll'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 80</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deltaMultiplier</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 81</span>         </span><span class="NAME">version</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.browser.version</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 82</span> 
<span class='line'> 83</span>     </span><span class="COMM">// normalize wheelDelta, wheelDeltaX, & wheelDeltaY for Safari</span><span class="WHIT">
<span class='line'> 84</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.browser.safari</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">originalEvent.wheelDelta</span><span class="PUNC">!==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 85</span>       </span><span class="NAME">this.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">originalEvent.wheelDeltaY</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">originalEvent.wheelDeltaX</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span>       </span><span class="NAME">this.wheelDeltaY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">originalEvent.wheelDeltaY</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 87</span>       </span><span class="NAME">this.wheelDeltaX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">originalEvent.wheelDeltaX</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 88</span> 
<span class='line'> 89</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">version</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">533</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">version</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">534</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 90</span>         </span><span class="NAME">deltaMultiplier</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">40</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 91</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 92</span>     </span><span class="COMM">// normalize wheelDelta for Firefox</span><span class="WHIT">
<span class='line'> 93</span>     </span><span class="COMM">// note that we multiple the delta on FF to make it's acceleration more </span><span class="WHIT">
<span class='line'> 94</span>     </span><span class="COMM">// natural.</span><span class="WHIT">
<span class='line'> 95</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">originalEvent.detail</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 96</span>       </span><span class="NAME">deltaMultiplier</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 97</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">originalEvent.axis</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">originalEvent.axis</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">originalEvent.HORIZONTAL_AXIS</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 98</span>         </span><span class="NAME">this.wheelDeltaX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalEvent.detail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 99</span>         </span><span class="NAME">this.wheelDeltaY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>100</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>101</span>         </span><span class="NAME">this.wheelDeltaY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalEvent.detail</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>102</span>         </span><span class="NAME">this.wheelDeltaX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>103</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>104</span> 
<span class='line'>105</span>     </span><span class="COMM">// handle all other legacy browser</span><span class="WHIT">
<span class='line'>106</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>107</span>       </span><span class="NAME">this.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.wheelDeltaY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">-</span><span class="NAME">originalEvent.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">originalEvent.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>108</span>       </span><span class="NAME">this.wheelDeltaX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>109</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>110</span>     
<span class='line'>111</span>     </span><span class="NAME">this.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">deltaMultiplier</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>112</span>     </span><span class="NAME">this.wheelDeltaX</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">deltaMultiplier</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>113</span>     </span><span class="NAME">this.wheelDeltaY</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">deltaMultiplier</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>115</span> 
<span class='line'>116</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>117</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>118</span> 
<span class='line'>119</span> </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="NAME">SC.Event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @scope SC.Event */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>120</span> 
<span class='line'>121</span>   </span><span class="COMM">/** 
<span class='line'>122</span>     Standard method to create a new event.  Pass the native browser event you
<span class='line'>123</span>     wish to wrap if needed.
<span class='line'>124</span>   */</span><span class="WHIT">
<span class='line'>125</span>   </span><span class="NAME">create</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">SC.Event</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>126</span> 
<span class='line'>127</span>   </span><span class="COMM">// the code below was borrowed from jQuery, Dean Edwards, and Prototype.js</span><span class="WHIT">
<span class='line'>128</span>   
<span class='line'>129</span>   </span><span class="COMM">/**
<span class='line'>130</span>     Bind an event to an element.
<span class='line'>131</span> 
<span class='line'>132</span>     This method will cause the passed handler to be executed whenever a
<span class='line'>133</span>     relevant event occurs on the named element.  This method supports a
<span class='line'>134</span>     variety of handler types, depending on the kind of support you need.
<span class='line'>135</span>     
<span class='line'>136</span>     h2. Simple Function Handlers
<span class='line'>137</span>     
<span class='line'>138</span>       SC.Event.add(anElement, "click", myClickHandler) ;
<span class='line'>139</span>       
<span class='line'>140</span>     The most basic type of handler you can pass is a function.  This function
<span class='line'>141</span>     will be executed everytime an event of the type you specify occurs on the
<span class='line'>142</span>     named element.  You can optionally pass an additional context object which
<span class='line'>143</span>     will be included on the event in the event.data property.
<span class='line'>144</span>     
<span class='line'>145</span>     When your handler function is called the, the function's "this" property
<span class='line'>146</span>     will point to the element the event occurred on.
<span class='line'>147</span>     
<span class='line'>148</span>     The click handler for this method must have a method signature like:
<span class='line'>149</span>     
<span class='line'>150</span>       function(event) { return YES|NO; }
<span class='line'>151</span>       
<span class='line'>152</span>     h2. Method Invocations
<span class='line'>153</span>     
<span class='line'>154</span>       SC.Event.add(anElement, "click", myObject, myObject.aMethod) ;
<span class='line'>155</span>       
<span class='line'>156</span>     Optionally you can specify a target object and a method on the object to 
<span class='line'>157</span>     be invoked when the event occurs.  This will invoke the method function
<span class='line'>158</span>     with the target object you pass as "this".  The method should have a 
<span class='line'>159</span>     signature like:
<span class='line'>160</span>     
<span class='line'>161</span>       function(event, targetElement) { return YES|NO; }
<span class='line'>162</span>       
<span class='line'>163</span>     Like function handlers, you can pass an additional context data paramater
<span class='line'>164</span>     that will be included on the event in the event.data property.
<span class='line'>165</span>       
<span class='line'>166</span>     h2. Handler Return Values
<span class='line'>167</span>     
<span class='line'>168</span>     Both handler functions should return YES if you want the event to 
<span class='line'>169</span>     continue to propagate and NO if you want it to stop.  Returning NO will
<span class='line'>170</span>     both stop bubbling of the event and will prevent any default action 
<span class='line'>171</span>     taken by the browser.  You can also control these two behaviors separately
<span class='line'>172</span>     by calling the stopPropagation() or preventDefault() methods on the event
<span class='line'>173</span>     itself, returning YES from your method.
<span class='line'>174</span>     
<span class='line'>175</span>     h2. Limitations
<span class='line'>176</span>     
<span class='line'>177</span>     Although SproutCore's event implementation is based on jQuery, it is 
<span class='line'>178</span>     much simpler in design.  Notably, it does not support namespaced events
<span class='line'>179</span>     and you can only pass a single type at a time.
<span class='line'>180</span>     
<span class='line'>181</span>     If you need more advanced event handling, consider the SC.ClassicResponder 
<span class='line'>182</span>     functionality provided by SproutCore or use your favorite DOM library.
<span class='line'>183</span> 
<span class='line'>184</span>     @param {Element} elem a DOM element, window, or document object
<span class='line'>185</span>     @param {String} eventType the event type you want to respond to
<span class='line'>186</span>     @param {Object} target The target object for a method call or a function.
<span class='line'>187</span>     @param {Object} method optional method or method name if target passed
<span class='line'>188</span>     @param {Object} context optional context to pass to the handler as event.data
<span class='line'>189</span>     @returns {Object} receiver
<span class='line'>190</span>   */</span><span class="WHIT">
<span class='line'>191</span>   </span><span class="NAME">add</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>192</span> 
<span class='line'>193</span>     </span><span class="COMM">// if a CQ object is passed in, either call add on each item in the </span><span class="WHIT">
<span class='line'>194</span>     </span><span class="COMM">// matched set, or simply get the first element and use that.</span><span class="WHIT">
<span class='line'>195</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">elem.isCoreQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>196</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>197</span>         </span><span class="NAME">elem.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>198</span>           </span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>199</span>         </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>200</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>201</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>202</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>203</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>204</span>     
<span class='line'>205</span>     </span><span class="COMM">// cannot register events on text nodes, etc.</span><span class="WHIT">
<span class='line'>206</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">elem.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">elem.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Event</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>207</span> 
<span class='line'>208</span>     </span><span class="COMM">// For whatever reason, IE has trouble passing the window object</span><span class="WHIT">
<span class='line'>209</span>     </span><span class="COMM">// around, causing it to be cloned in the process</span><span class="WHIT">
<span class='line'>210</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">elem.setInterval</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>211</span> 
<span class='line'>212</span>     </span><span class="COMM">// if target is a function, treat it as the method, with optional context</span><span class="WHIT">
<span class='line'>213</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>214</span>       </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>215</span>       
<span class='line'>216</span>     </span><span class="COMM">// handle case where passed method is a key on the target.</span><span class="WHIT">
<span class='line'>217</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>218</span>       </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>219</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>220</span> 
<span class='line'>221</span>     </span><span class="COMM">// Get the handlers queue for this element/eventType.  If the queue does</span><span class="WHIT">
<span class='line'>222</span>     </span><span class="COMM">// not exist yet, create it and also setup the shared listener for this</span><span class="WHIT">
<span class='line'>223</span>     </span><span class="COMM">// eventType.</span><span class="WHIT">
<span class='line'>224</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"events"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"events"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>225</span>         </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>226</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">handlers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>227</span>       </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>228</span>       </span><span class="NAME">this._addEventListener</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>229</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>230</span>     
<span class='line'>231</span>     </span><span class="COMM">// Build the handler array and add to queue</span><span class="WHIT">
<span class='line'>232</span>     </span><span class="NAME">handlers</span><span class="PUNC">[</span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>233</span>     </span><span class="NAME">SC.Event._global</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// optimization for global triggers</span><span class="WHIT">
<span class='line'>234</span> 
<span class='line'>235</span>     </span><span class="COMM">// Nullify elem to prevent memory leaks in IE</span><span class="WHIT">
<span class='line'>236</span>     </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>237</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>238</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>239</span> 
<span class='line'>240</span>   </span><span class="COMM">/**
<span class='line'>241</span>     Removes a specific handler or all handlers for an event or event+type.
<span class='line'>242</span> 
<span class='line'>243</span>     To remove a specific handler, you must pass in the same function or the
<span class='line'>244</span>     same target and method as you passed into SC.Event.add().  See that method
<span class='line'>245</span>     for full documentation on the parameters you can pass in.
<span class='line'>246</span>     
<span class='line'>247</span>     If you omit a specific handler but provide both an element and eventType,
<span class='line'>248</span>     then all handlers for that element will be removed.  If you provide only
<span class='line'>249</span>     and element, then all handlers for all events on that element will be
<span class='line'>250</span>     removed.
<span class='line'>251</span>     
<span class='line'>252</span>     h2. Limitations
<span class='line'>253</span>     
<span class='line'>254</span>     Although SproutCore's event implementation is based on jQuery, it is 
<span class='line'>255</span>     much simpler in design.  Notably, it does not support namespaced events
<span class='line'>256</span>     and you can only pass a single type at a time.
<span class='line'>257</span>     
<span class='line'>258</span>     If you need more advanced event handling, consider the SC.ClassicResponder 
<span class='line'>259</span>     functionality provided by SproutCore or use your favorite DOM library.
<span class='line'>260</span>     
<span class='line'>261</span>     @param {Element} elem a DOM element, window, or document object
<span class='line'>262</span>     @param {String} eventType the event type to remove
<span class='line'>263</span>     @param {Object} target The target object for a method call.  Or a function.
<span class='line'>264</span>     @param {Object} method optional name of method
<span class='line'>265</span>     @returns {Object} receiver
<span class='line'>266</span>   */</span><span class="WHIT">
<span class='line'>267</span>   </span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>268</span> 
<span class='line'>269</span>     </span><span class="COMM">// if a CQ object is passed in, either call add on each item in the </span><span class="WHIT">
<span class='line'>270</span>     </span><span class="COMM">// matched set, or simply get the first element and use that.</span><span class="WHIT">
<span class='line'>271</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">elem.isCoreQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>272</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>273</span>         </span><span class="NAME">elem.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>274</span>           </span><span class="NAME">this.remove</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>275</span>         </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>276</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>277</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>278</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>279</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>280</span>     
<span class='line'>281</span>     </span><span class="COMM">// don't do events on text and comment nodes</span><span class="WHIT">
<span class='line'>282</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">elem.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">elem.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Event</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>283</span> 
<span class='line'>284</span>     </span><span class="COMM">// For whatever reason, IE has trouble passing the window object</span><span class="WHIT">
<span class='line'>285</span>     </span><span class="COMM">// around, causing it to be cloned in the process</span><span class="WHIT">
<span class='line'>286</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">elem.setInterval</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>287</span> 
<span class='line'>288</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"events"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>289</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">events</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do if no events are registered</span><span class="WHIT">
<span class='line'>290</span> 
<span class='line'>291</span>     </span><span class="COMM">// if no type is provided, remove all types for this element.</span><span class="WHIT">
<span class='line'>292</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>293</span>       </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">eventType</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.remove</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> 
<span class='line'>295</span>     </span><span class="COMM">// otherwise, remove the handler for this specific eventType if found</span><span class="WHIT">
<span class='line'>296</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>297</span> 
<span class='line'>298</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cleanupHandlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>299</span>       
<span class='line'>300</span>       </span><span class="COMM">// if a target/method is provided, remove only that one</span><span class="WHIT">
<span class='line'>301</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>302</span>         
<span class='line'>303</span>         </span><span class="COMM">// normalize the target/method</span><span class="WHIT">
<span class='line'>304</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>305</span>           </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>306</span>         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>307</span>           </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>308</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>309</span>         
<span class='line'>310</span>         </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">[</span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>311</span>         
<span class='line'>312</span>         </span><span class="COMM">// check to see if there are handlers left on this event/eventType.</span><span class="WHIT">
<span class='line'>313</span>         </span><span class="COMM">// if not, then cleanup the handlers.</span><span class="WHIT">
<span class='line'>314</span>         </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span>         </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>316</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">===</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">cleanupHandlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>317</span> 
<span class='line'>318</span>       </span><span class="COMM">// otherwise, just cleanup all handlers</span><span class="WHIT">
<span class='line'>319</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">cleanupHandlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>320</span>       
<span class='line'>321</span>       </span><span class="COMM">// If there are no more handlers left on this event type, remove </span><span class="WHIT">
<span class='line'>322</span>       </span><span class="COMM">// eventType hash from queue.</span><span class="WHIT">
<span class='line'>323</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cleanupHandlers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>324</span>         </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>325</span>         </span><span class="NAME">this._removeEventListener</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>326</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>327</span>       
<span class='line'>328</span>       </span><span class="COMM">// verify that there are still events registered on this element.  If </span><span class="WHIT">
<span class='line'>329</span>       </span><span class="COMM">// there aren't, cleanup the element completely to avoid memory leaks.</span><span class="WHIT">
<span class='line'>330</span>       </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>331</span>       </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">events</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>332</span>       </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>333</span>         </span><span class="NAME">SC.removeData</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"events"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>334</span>         </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._elements</span><span class="PUNC">[</span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// important to avoid leaks</span><span class="WHIT">
<span class='line'>335</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>336</span>       
<span class='line'>337</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>338</span>     
<span class='line'>339</span>     </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// avoid memory leaks</span><span class="WHIT">
<span class='line'>340</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>341</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>342</span> 
<span class='line'>343</span>   </span><span class="NAME">NO_BUBBLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'blur'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'focus'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'change'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>344</span>   
<span class='line'>345</span>   </span><span class="COMM">/**
<span class='line'>346</span>     Generates a simulated event object.  This is mostly useful for unit 
<span class='line'>347</span>     testing.  You can pass the return value of this property into the 
<span class='line'>348</span>     trigger() method to actually send the event.
<span class='line'>349</span>     
<span class='line'>350</span>     @param {Element} elem the element the event targets
<span class='line'>351</span>     @param {String} eventType event type.  mousedown, mouseup, etc
<span class='line'>352</span>     @param {Hash} attrs optional additonal attributes to apply to event.
<span class='line'>353</span>     @returns {Hash} simulated event object
<span class='line'>354</span>   */</span><span class="WHIT">
<span class='line'>355</span>   </span><span class="NAME">simulateEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>356</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.create</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>357</span>       </span><span class="NAME">type</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>358</span>       </span><span class="NAME">target</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>359</span>       </span><span class="NAME">preventDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.cancelled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>360</span>       </span><span class="NAME">stopPropagation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.bubbles</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>361</span>       </span><span class="NAME">allowDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.hasCustomEventHandling</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>362</span>       </span><span class="NAME">timeStamp</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Date.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>363</span>       </span><span class="NAME">bubbles</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.NO_BUBBLE.indexOf</span><span class="PUNC">(</span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>364</span>       </span><span class="NAME">cancelled</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>365</span>       </span><span class="NAME">normalized</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT">
<span class='line'>366</span>     </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>367</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>368</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>369</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>370</span>   
<span class='line'>371</span>   </span><span class="COMM">/**
<span class='line'>372</span>     Trigger an event execution immediately.  You can use this method to 
<span class='line'>373</span>     simulate arbitrary events on arbitary elements.
<span class='line'>374</span> 
<span class='line'>375</span>     h2. Limitations
<span class='line'>376</span>     
<span class='line'>377</span>     Note that although this is based on the jQuery implementation, it is 
<span class='line'>378</span>     much simpler.  Notably namespaced events are not supported and you cannot
<span class='line'>379</span>     trigger events globally.
<span class='line'>380</span>     
<span class='line'>381</span>     If you need more advanced event handling, consider the SC.Responder 
<span class='line'>382</span>     functionality provided by SproutCore or use your favorite DOM library.
<span class='line'>383</span> 
<span class='line'>384</span>     h2. Example
<span class='line'>385</span>     
<span class='line'>386</span>     {{{
<span class='line'>387</span>       SC.Event.trigger(view.get('layer'), 'mousedown');
<span class='line'>388</span>     }}}
<span class='line'>389</span>     
<span class='line'>390</span>     @param elem {Element} the target element
<span class='line'>391</span>     @param eventType {String} the event type
<span class='line'>392</span>     @param args {Array} optional argument or arguments to pass to handler.
<span class='line'>393</span>     @param donative ??
<span class='line'>394</span>     @returns {Boolean} Return value of trigger or undefined if not fired
<span class='line'>395</span>   */</span><span class="WHIT">
<span class='line'>396</span>   </span><span class="NAME">trigger</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">donative</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>397</span> 
<span class='line'>398</span>     </span><span class="COMM">// if a CQ object is passed in, either call add on each item in the </span><span class="WHIT">
<span class='line'>399</span>     </span><span class="COMM">// matched set, or simply get the first element and use that.</span><span class="WHIT">
<span class='line'>400</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">elem.isCoreQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>401</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>402</span>         </span><span class="NAME">elem.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>403</span>           </span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">donative</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>404</span>         </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>405</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>406</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>407</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>408</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>409</span> 
<span class='line'>410</span>     </span><span class="COMM">// don't do events on text and comment nodes</span><span class="WHIT">
<span class='line'>411</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">elem.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">elem.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>412</span>     
<span class='line'>413</span>     </span><span class="COMM">// Normalize to an array</span><span class="WHIT">
<span class='line'>414</span>     </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.A</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>415</span> 
<span class='line'>416</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>417</span>         </span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">current</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">onfoo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isClick</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>418</span> 
<span class='line'>419</span>     </span><span class="COMM">// Get the event to pass, creating a fake one if necessary</span><span class="WHIT">
<span class='line'>420</span>     </span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>421</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">event.preventDefault</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>422</span>       </span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.simulateEvent</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>423</span>       </span><span class="NAME">args.unshift</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>424</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>425</span>     
<span class='line'>426</span>     </span><span class="NAME">event.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>427</span>     
<span class='line'>428</span>     </span><span class="COMM">// Trigger the event - bubble if enabled</span><span class="WHIT">
<span class='line'>429</span>     </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>430</span>     </span><span class="KEYW">do</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>431</span>       </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.handle.apply</span><span class="PUNC">(</span><span class="NAME">current</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>432</span>       </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">current</span><span class="PUNC">===</span><span class="NAME">document</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">current.parentNode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>433</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">event.bubbles</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">current</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">    
<span class='line'>434</span>     </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>435</span> 
<span class='line'>436</span>     </span><span class="COMM">// Handle triggering native .onfoo handlers</span><span class="WHIT">
<span class='line'>437</span>     </span><span class="NAME">onfoo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">[</span><span class="STRN">"on"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>438</span>     </span><span class="NAME">isClick</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.CoreQuery.nodeName</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'a'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>439</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">isClick</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">onfoo</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">onfoo.apply</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>440</span> 
<span class='line'>441</span>     </span><span class="COMM">// Trigger the native events (except for clicks on links)</span><span class="WHIT">
<span class='line'>442</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">donative</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">isClick</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>443</span>       </span><span class="NAME">this.triggered</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>444</span>       </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>445</span>         </span><span class="NAME">elem</span><span class="PUNC">[</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>446</span>       </span><span class="COMM">// prevent IE from throwing an error for some hidden elements</span><span class="WHIT">
<span class='line'>447</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>448</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>449</span>     
<span class='line'>450</span>     </span><span class="NAME">this.triggered</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>451</span> 
<span class='line'>452</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>454</span> 
<span class='line'>455</span>   </span><span class="COMM">/**
<span class='line'>456</span>     This method will handle the passed event, finding any registered listeners
<span class='line'>457</span>     and executing them.  If you have an event you want handled, you can 
<span class='line'>458</span>     manually invoke this method.  This function expects it's "this" value to
<span class='line'>459</span>     be the element the event occurred on, so you should always call this 
<span class='line'>460</span>     method like:
<span class='line'>461</span>     
<span class='line'>462</span>       SC.Event.handle.call(element, event) ;
<span class='line'>463</span>       
<span class='line'>464</span>     Note that like other parts of this library, the handle function does not
<span class='line'>465</span>     support namespaces.
<span class='line'>466</span>     
<span class='line'>467</span>     @param event {Event} the event to handle
<span class='line'>468</span>     @returns {Boolean}
<span class='line'>469</span>   */</span><span class="WHIT">
<span class='line'>470</span>   </span><span class="NAME">handle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>471</span> 
<span class='line'>472</span>     </span><span class="COMM">// ignore events triggered after window is unloaded or if double-called</span><span class="WHIT">
<span class='line'>473</span>     </span><span class="COMM">// from within a trigger.</span><span class="WHIT">
<span class='line'>474</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">SC</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">SC.Event.triggered</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>475</span>     
<span class='line'>476</span>     </span><span class="COMM">// returned undefined or NO</span><span class="WHIT">
<span class='line'>477</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">namespace</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">all</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>478</span> 
<span class='line'>479</span>     </span><span class="COMM">// normalize event across browsers.  The new event will actually wrap the</span><span class="WHIT">
<span class='line'>480</span>     </span><span class="COMM">// real event with a normalized API.</span><span class="WHIT">
<span class='line'>481</span>     </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>482</span>     </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.normalizeEvent</span><span class="PUNC">(</span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>483</span> 
<span class='line'>484</span>     </span><span class="COMM">// get the handlers for this event type</span><span class="WHIT">
<span class='line'>485</span>     </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"events"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">event.type</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>486</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">handlers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>487</span>     
<span class='line'>488</span>     </span><span class="COMM">// invoke all handlers</span><span class="WHIT">
<span class='line'>489</span>     </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>490</span>       </span><span class="NAME">handler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>491</span>       </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>492</span> 
<span class='line'>493</span>       </span><span class="COMM">// Pass in a reference to the handler function itself</span><span class="WHIT">
<span class='line'>494</span>       </span><span class="COMM">// So that we can later remove it</span><span class="WHIT">
<span class='line'>495</span>       </span><span class="NAME">event.handler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>496</span>       </span><span class="NAME">event.data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>497</span> 
<span class='line'>498</span>       </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>499</span>       </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">method.apply</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span>       
<span class='line'>501</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>502</span> 
<span class='line'>503</span>       </span><span class="COMM">// if method returned NO, do not continue.  Stop propogation and</span><span class="WHIT">
<span class='line'>504</span>       </span><span class="COMM">// return default.  Note that we test explicitly for NO since </span><span class="WHIT">
<span class='line'>505</span>       </span><span class="COMM">// if the handler returns no specific value, we do not want to stop.</span><span class="WHIT">
<span class='line'>506</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>507</span>         </span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span>         </span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>509</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>510</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>511</span> 
<span class='line'>512</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>513</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>514</span> 
<span class='line'>515</span>   </span><span class="COMM">/**
<span class='line'>516</span>     This method is called just before the window unloads to unhook all 
<span class='line'>517</span>     registered events.
<span class='line'>518</span>   */</span><span class="WHIT">
<span class='line'>519</span>   </span><span class="NAME">unload</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>520</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._elements</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>521</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.remove</span><span class="PUNC">(</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>522</span>     
<span class='line'>523</span>     </span><span class="COMM">// just in case some book-keeping was screwed up.  avoid memory leaks</span><span class="WHIT">
<span class='line'>524</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>525</span>     </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._elements</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>526</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>527</span>   
<span class='line'>528</span>   </span><span class="COMM">/**
<span class='line'>529</span>     This hash contains handlers for special or custom events.  You can add
<span class='line'>530</span>     your own handlers for custom events here by simply naming the event and
<span class='line'>531</span>     including a hash with the following properties:
<span class='line'>532</span>     
<span class='line'>533</span>      - setup: this function should setup the handler or return NO
<span class='line'>534</span>      - teardown: this function should remove the event listener
<span class='line'>535</span>      
<span class='line'>536</span>   */</span><span class="WHIT">
<span class='line'>537</span>   </span><span class="NAME">special</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>538</span>     
<span class='line'>539</span>     </span><span class="NAME">ready</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>540</span>       </span><span class="NAME">setup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>541</span>         </span><span class="COMM">// Make sure the ready event is setup</span><span class="WHIT">
<span class='line'>542</span>         </span><span class="NAME">SC._bindReady</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>543</span>         </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>544</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>545</span> 
<span class='line'>546</span>       </span><span class="NAME">teardown</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>547</span> 
<span class='line'>548</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>549</span> 
<span class='line'>550</span>     </span><span class="COMM">/** @private
<span class='line'>551</span>         Implement support for mouseenter on browsers other than IE */</span><span class="WHIT">
<span class='line'>552</span>     </span><span class="NAME">mouseenter</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>553</span>       </span><span class="NAME">setup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>554</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>555</span>         </span><span class="NAME">SC.Event.add</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mouseover'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.Event.special.mouseenter.handler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>556</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>557</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>558</span> 
<span class='line'>559</span>       </span><span class="NAME">teardown</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>560</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span>         </span><span class="NAME">SC.Event.remove</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mouseover'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.Event.special.mouseenter.handler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>564</span> 
<span class='line'>565</span>       </span><span class="NAME">handler</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>566</span>         </span><span class="COMM">// If we actually just moused on to a sub-element, ignore it</span><span class="WHIT">
<span class='line'>567</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">SC.Event._withinElement</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>568</span>         </span><span class="COMM">// Execute the right handlers by setting the event type to mouseenter</span><span class="WHIT">
<span class='line'>569</span>         </span><span class="NAME">event.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"mouseenter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>570</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Event.handle.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>571</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>572</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>573</span> 
<span class='line'>574</span>     </span><span class="COMM">/** @private
<span class='line'>575</span>         Implement support for mouseleave on browsers other than IE */</span><span class="WHIT">
<span class='line'>576</span>     </span><span class="NAME">mouseleave</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>577</span>       </span><span class="NAME">setup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>578</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>579</span>         </span><span class="NAME">SC.Event.add</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"mouseout"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.Event.special.mouseleave.handler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>580</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>581</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>582</span> 
<span class='line'>583</span>       </span><span class="NAME">teardown</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>584</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">SC.browser.msie</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>585</span>         </span><span class="NAME">SC.Event.remove</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"mouseout"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.Event.special.mouseleave.handler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>586</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>587</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>588</span> 
<span class='line'>589</span>       </span><span class="NAME">handler</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>590</span>         </span><span class="COMM">// If we actually just moused on to a sub-element, ignore it</span><span class="WHIT">
<span class='line'>591</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">SC.Event._withinElement</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>592</span>         </span><span class="COMM">// Execute the right handlers by setting the event type to mouseleave</span><span class="WHIT">
<span class='line'>593</span>         </span><span class="NAME">event.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"mouseleave"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>594</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Event.handle.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>595</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>596</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>597</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>598</span> 
<span class='line'>599</span>   </span><span class="NAME">KEY_BACKSPACE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>600</span>   </span><span class="NAME">KEY_TAB</span><span class="PUNC">:</span><span class="WHIT">       </span><span class="NUMB">9</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>601</span>   </span><span class="NAME">KEY_RETURN</span><span class="PUNC">:</span><span class="WHIT">   </span><span class="NUMB">13</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>602</span>   </span><span class="NAME">KEY_ESC</span><span class="PUNC">:</span><span class="WHIT">      </span><span class="NUMB">27</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>603</span>   </span><span class="NAME">KEY_LEFT</span><span class="PUNC">:</span><span class="WHIT">     </span><span class="NUMB">37</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>604</span>   </span><span class="NAME">KEY_UP</span><span class="PUNC">:</span><span class="WHIT">       </span><span class="NUMB">38</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>605</span>   </span><span class="NAME">KEY_RIGHT</span><span class="PUNC">:</span><span class="WHIT">    </span><span class="NUMB">39</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>606</span>   </span><span class="NAME">KEY_DOWN</span><span class="PUNC">:</span><span class="WHIT">     </span><span class="NUMB">40</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>607</span>   </span><span class="NAME">KEY_DELETE</span><span class="PUNC">:</span><span class="WHIT">   </span><span class="NUMB">46</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>608</span>   </span><span class="NAME">KEY_HOME</span><span class="PUNC">:</span><span class="WHIT">     </span><span class="NUMB">36</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>609</span>   </span><span class="NAME">KEY_END</span><span class="PUNC">:</span><span class="WHIT">      </span><span class="NUMB">35</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>610</span>   </span><span class="NAME">KEY_PAGEUP</span><span class="PUNC">:</span><span class="WHIT">   </span><span class="NUMB">33</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>611</span>   </span><span class="NAME">KEY_PAGEDOWN</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">34</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>612</span>   </span><span class="NAME">KEY_INSERT</span><span class="PUNC">:</span><span class="WHIT">   </span><span class="NUMB">45</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>613</span>     
<span class='line'>614</span>   </span><span class="NAME">_withinElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>615</span>     </span><span class="COMM">// Check if mouse(over|out) are still within the same parent element</span><span class="WHIT">
<span class='line'>616</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.relatedTarget</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>617</span>     
<span class='line'>618</span>     </span><span class="COMM">// Traverse up the tree</span><span class="WHIT">
<span class='line'>619</span>     </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>620</span>       </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.parentNode</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">error</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>621</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>622</span> 
<span class='line'>623</span>     </span><span class="COMM">// Return YES if we actually just moused on to a sub-element</span><span class="WHIT">
<span class='line'>624</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>625</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>626</span>   
<span class='line'>627</span>   </span><span class="COMM">/** @private
<span class='line'>628</span>     Adds the primary event listener for the named type on the element.
<span class='line'>629</span>     
<span class='line'>630</span>     If the event type has a special handler defined in SC.Event.special, 
<span class='line'>631</span>     then that handler will be used.  Otherwise the normal browser method will
<span class='line'>632</span>     be used.
<span class='line'>633</span>     
<span class='line'>634</span>     @param elem {Element} the target element
<span class='line'>635</span>     @param eventType {String} the event type
<span class='line'>636</span>   */</span><span class="WHIT">
<span class='line'>637</span>   </span><span class="NAME">_addEventListener</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>638</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">special</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.special</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>639</span> 
<span class='line'>640</span>     </span><span class="COMM">// Check for a special event handler</span><span class="WHIT">
<span class='line'>641</span>     </span><span class="COMM">// Only use addEventListener/attachEvent if the special</span><span class="WHIT">
<span class='line'>642</span>     </span><span class="COMM">// events handler returns NO</span><span class="WHIT">
<span class='line'>643</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">special</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">special.setup.call</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="NAME">NO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>644</span>       
<span class='line'>645</span>       </span><span class="COMM">// Save element in cache.  This must be removed later to avoid </span><span class="WHIT">
<span class='line'>646</span>       </span><span class="COMM">// memory leaks.</span><span class="WHIT">
<span class='line'>647</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">guid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>648</span>       </span><span class="NAME">this._elements</span><span class="PUNC">[</span><span class="NAME">guid</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>649</span>       
<span class='line'>650</span>       </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"listener"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"listener"</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>651</span>        </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>652</span>          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Event.handle.apply</span><span class="PUNC">(</span><span class="NAME">SC.Event._elements</span><span class="PUNC">[</span><span class="NAME">guid</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>653</span>       </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>654</span>       
<span class='line'>655</span>       </span><span class="COMM">// Bind the global event handler to the element</span><span class="WHIT">
<span class='line'>656</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.addEventListener</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>657</span>         </span><span class="NAME">elem.addEventListener</span><span class="PUNC">(</span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>658</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.attachEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>659</span>         </span><span class="COMM">// attachEvent is not working for IE8 and xhr objects</span><span class="WHIT">
<span class='line'>660</span>         </span><span class="COMM">// there is currently a hack in request , but it needs to fixed here.</span><span class="WHIT">
<span class='line'>661</span>         </span><span class="NAME">elem.attachEvent</span><span class="PUNC">(</span><span class="STRN">"on"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>662</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>663</span>       </span><span class="COMM">//  </span><span class="WHIT">
<span class='line'>664</span>       </span><span class="COMM">// else {</span><span class="WHIT">
<span class='line'>665</span>       </span><span class="COMM">//         elem.onreadystatechange = listener;</span><span class="WHIT">
<span class='line'>666</span>       </span><span class="COMM">//       }</span><span class="WHIT">
<span class='line'>667</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>668</span>     
<span class='line'>669</span>     </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">special</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// avoid memory leak</span><span class="WHIT">
<span class='line'>670</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>671</span> 
<span class='line'>672</span>   </span><span class="COMM">/** @private
<span class='line'>673</span>     Removes the primary event listener for the named type on the element.
<span class='line'>674</span>     
<span class='line'>675</span>     If the event type has a special handler defined in SC.Event.special, 
<span class='line'>676</span>     then that handler will be used.  Otherwise the normal browser method will
<span class='line'>677</span>     be used.
<span class='line'>678</span>     
<span class='line'>679</span>     Note that this will not clear the _elements hash from the element.  You
<span class='line'>680</span>     must call SC.Event.unload() on unload to make sure that is cleared.
<span class='line'>681</span>     
<span class='line'>682</span>     @param elem {Element} the target element
<span class='line'>683</span>     @param eventType {String} the event type
<span class='line'>684</span>   */</span><span class="WHIT">
<span class='line'>685</span>   </span><span class="NAME">_removeEventListener</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>686</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">special</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.special</span><span class="PUNC">[</span><span class="NAME">eventType</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>687</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">special</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">special.teardown.call</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="NAME">NO</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>688</span>       </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.data</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"listener"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>689</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listener</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>690</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.removeEventListener</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>691</span>           </span><span class="NAME">elem.removeEventListener</span><span class="PUNC">(</span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span>         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">elem.detachEvent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>693</span>           </span><span class="NAME">elem.detachEvent</span><span class="PUNC">(</span><span class="STRN">"on"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">eventType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>694</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>695</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>696</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>697</span>     
<span class='line'>698</span>     </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">special</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>699</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>700</span> 
<span class='line'>701</span>   </span><span class="NAME">_elements</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>702</span>   
<span class='line'>703</span>   </span><span class="COMM">// implement preventDefault() in a cross platform way</span><span class="WHIT">
<span class='line'>704</span>   
<span class='line'>705</span>   </span><span class="COMM">/** @private Take an incoming event and convert it to a normalized event. */</span><span class="WHIT">
<span class='line'>706</span>   </span><span class="NAME">normalizeEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>707</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>708</span>       </span><span class="COMM">// IE can't do event.normalized on an Event object</span><span class="WHIT">
<span class='line'>709</span>       </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Event.create</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>710</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>711</span>       </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">event.normalized</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">event</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.Event.create</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>712</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>713</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>714</span>   
<span class='line'>715</span>   </span><span class="NAME">_global</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>716</span> 
<span class='line'>717</span>   </span><span class="COMM">/** @private properties to copy from native event onto the event */</span><span class="WHIT">
<span class='line'>718</span>   </span><span class="NAME">_props</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target timeStamp toElement type view which touches targetTouches changedTouches animationName elapsedTime"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>719</span>   
<span class='line'>720</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>721</span> 
<span class='line'>722</span> </span><span class="NAME">SC.Event.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>723</span> 
<span class='line'>724</span>   </span><span class="COMM">/**
<span class='line'>725</span>     Set to YES if you have called either preventDefault() or stopPropagation().  This allows a generic event handler to notice if you want to provide detailed control over how the browser handles the real event.
<span class='line'>726</span>   */</span><span class="WHIT">
<span class='line'>727</span>   </span><span class="NAME">hasCustomEventHandling</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>728</span>   
<span class='line'>729</span>   </span><span class="COMM">/**
<span class='line'>730</span>     Returns the touches owned by the supplied view.
<span class='line'>731</span>   */</span><span class="WHIT">
<span class='line'>732</span>   </span><span class="NAME">touchesForView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>733</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.touchContext</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.touchContext.touchesForView</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>734</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>735</span>   
<span class='line'>736</span>   </span><span class="COMM">/**
<span class='line'>737</span>     Returns average data--x, y, and d (distance)--for the touches owned by the supplied view.
<span class='line'>738</span>   */</span><span class="WHIT">
<span class='line'>739</span>   </span><span class="NAME">averagedTouchesForView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>740</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.touchContext</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.touchContext.averagedTouchesForView</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>741</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>742</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>743</span>   
<span class='line'>744</span>   </span><span class="COMM">/**
<span class='line'>745</span>     Indicates that you want to allow the normal default behavior.  Sets
<span class='line'>746</span>     the hasCustomEventHandling property to YES but does not cancel the event.
<span class='line'>747</span>     
<span class='line'>748</span>     @returns {SC.Event} receiver
<span class='line'>749</span>   */</span><span class="WHIT">
<span class='line'>750</span>   </span><span class="NAME">allowDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>751</span>     </span><span class="NAME">this.hasCustomEventHandling</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>752</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">  
<span class='line'>753</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>754</span>   
<span class='line'>755</span>   </span><span class="COMM">/** 
<span class='line'>756</span>     Implements W3C standard.  Will prevent the browser from performing its
<span class='line'>757</span>     default action on this event.
<span class='line'>758</span>     
<span class='line'>759</span>     @returns {SC.Event} receiver
<span class='line'>760</span>   */</span><span class="WHIT">
<span class='line'>761</span>   </span><span class="NAME">preventDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>762</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.originalEvent</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>763</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>764</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">evt.preventDefault</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">evt.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>765</span>       </span><span class="NAME">evt.returnValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// IE</span><span class="WHIT">
<span class='line'>766</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>767</span>     </span><span class="NAME">this.hasCustomEventHandling</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>768</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>769</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>770</span> 
<span class='line'>771</span>   </span><span class="COMM">/**
<span class='line'>772</span>     Implements W3C standard.  Prevents further bubbling of the event.
<span class='line'>773</span>     
<span class='line'>774</span>     @returns {SC.Event} receiver
<span class='line'>775</span>   */</span><span class="WHIT">
<span class='line'>776</span>   </span><span class="NAME">stopPropagation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>777</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.originalEvent</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>778</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>779</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">evt.stopPropagation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">evt.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>780</span>       </span><span class="NAME">evt.cancelBubble</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// IE</span><span class="WHIT">
<span class='line'>781</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>782</span>     </span><span class="NAME">this.hasCustomEventHandling</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>783</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>784</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>785</span> 
<span class='line'>786</span>   </span><span class="COMM">/** 
<span class='line'>787</span>     Stops both the default action and further propogation.  This is more 
<span class='line'>788</span>     convenient than calling both.
<span class='line'>789</span>     
<span class='line'>790</span>     @returns {SC.Event} receiver
<span class='line'>791</span>   */</span><span class="WHIT">
<span class='line'>792</span>   </span><span class="NAME">stop</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>793</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>794</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>795</span>   
<span class='line'>796</span>   </span><span class="COMM">/** Always YES to indicate the event was normalized. */</span><span class="WHIT">
<span class='line'>797</span>   </span><span class="NAME">normalized</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>798</span> 
<span class='line'>799</span>   </span><span class="COMM">/** Returns the pressed character (found in this.which) as a string. */</span><span class="WHIT">
<span class='line'>800</span>   </span><span class="NAME">getCharString</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>801</span>       </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">SC.browser.msie</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>802</span>         </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.keyCode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.keyCode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">9</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.keyCode</span><span class="PUNC">>=</span><span class="NUMB">37</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.keyCode</span><span class="PUNC">&lt;=</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>803</span>           </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>804</span>         </span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>805</span>           </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.keyCode</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">this.keyCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">  
<span class='line'>806</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>807</span>       </span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>808</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.charCode</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">this.charCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>809</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>810</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>811</span>   
<span class='line'>812</span>   </span><span class="COMM">/** Returns character codes for the event.  The first value is the normalized code string, with any shift or ctrl characters added to the begining.  The second value is the char string by itself.
<span class='line'>813</span>   
<span class='line'>814</span>     @returns {Array}
<span class='line'>815</span>   */</span><span class="WHIT">
<span class='line'>816</span>   </span><span class="NAME">commandCodes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>817</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">code</span><span class="PUNC">=</span><span class="NAME">this.keyCode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">modifiers</span><span class="PUNC">=</span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lowercase</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>818</span>     
<span class='line'>819</span>     </span><span class="COMM">// handle function keys.</span><span class="WHIT">
<span class='line'>820</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">code</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>821</span>       </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.FUNCTION_KEYS</span><span class="PUNC">[</span><span class="NAME">code</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>822</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.altKey</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.ctrlKey</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.metaKey</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>823</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.PRINTABLE_KEYS</span><span class="PUNC">[</span><span class="NAME">code</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>824</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>825</span>       
<span class='line'>826</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>827</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.altKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">modifiers</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'alt_'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>828</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.ctrlKey</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.metaKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">modifiers</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'ctrl_'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>829</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.shiftKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">modifiers</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'shift_'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>830</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>831</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>832</span> 
<span class='line'>833</span>     </span><span class="COMM">// otherwise just go get the right key.</span><span class="WHIT">
<span class='line'>834</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>835</span>       </span><span class="NAME">code</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.which</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>836</span>       </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">code</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>837</span>       </span><span class="NAME">lowercase</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>838</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.metaKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>839</span>         </span><span class="NAME">modifiers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'meta_'</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>840</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lowercase</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>841</span>         
<span class='line'>842</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>843</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>844</span> 
<span class='line'>845</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">modifiers</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>846</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>847</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>848</span>     
<span class='line'>849</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>850</span> 
<span class='line'>851</span> </span><span class="COMM">// Also provide a Prototype-like API so that people can use either one.</span><span class="WHIT">
<span class='line'>852</span> 
<span class='line'>853</span> </span><span class="COMM">/** Alias for add() method.  This provides a Prototype-like API. */</span><span class="WHIT">
<span class='line'>854</span> </span><span class="NAME">SC.Event.observe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.add</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>855</span> 
<span class='line'>856</span> </span><span class="COMM">/** Alias for remove() method.  This provides a Prototype-like API */</span><span class="WHIT">
<span class='line'>857</span> </span><span class="NAME">SC.Event.stopObserving</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.remove</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>858</span> 
<span class='line'>859</span> </span><span class="COMM">/** Alias for trigger() method.  This provides a Prototype-like API */</span><span class="WHIT">
<span class='line'>860</span> </span><span class="NAME">SC.Event.fire</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Event.trigger</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>861</span> 
<span class='line'>862</span> </span><span class="COMM">// Register unload handler to eliminate any registered handlers</span><span class="WHIT">
<span class='line'>863</span> </span><span class="COMM">// This avoids leaks in IE and issues with mouseout or other handlers on </span><span class="WHIT">
<span class='line'>864</span> </span><span class="COMM">// other browsers.</span><span class="WHIT">
<span class='line'>865</span> 
<span class='line'>866</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">SC.browser.msie</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Event.add</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'unload'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.Event.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.Event.unload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>867</span> 
<span class='line'>868</span> </span><span class="NAME">SC.MODIFIER_KEYS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>869</span>   </span><span class="NUMB">16</span><span class="PUNC">:</span><span class="STRN">'shift'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">17</span><span class="PUNC">:</span><span class="STRN">'ctrl'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">18</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'alt'</span><span class="WHIT">
<span class='line'>870</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>871</span> 
<span class='line'>872</span> </span><span class="NAME">SC.FUNCTION_KEYS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>873</span>   </span><span class="NUMB">8</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'backspace'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="NUMB">9</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tab'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="NUMB">13</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'return'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="NUMB">19</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'pause'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="NUMB">27</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'escape'</span><span class="PUNC">,</span><span class="WHIT">  
<span class='line'>874</span>   </span><span class="NUMB">33</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'pageup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">34</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'pagedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">35</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'end'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">36</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'home'</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>875</span>   </span><span class="NUMB">37</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">38</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'up'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">39</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'right'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">40</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'down'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">44</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'printscreen'</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>876</span>   </span><span class="NUMB">45</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'insert'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">46</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'delete'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">112</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f1'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">113</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f2'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">114</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f3'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">115</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f4'</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>877</span>   </span><span class="NUMB">116</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f5'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">117</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f7'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">119</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f8'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">120</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f9'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">121</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f10'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">122</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f11'</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>878</span>   </span><span class="NUMB">123</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'f12'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">144</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'numlock'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">145</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'scrolllock'</span><span class="WHIT">
<span class='line'>879</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>880</span> 
<span class='line'>881</span> </span><span class="NAME">SC.PRINTABLE_KEYS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>882</span>   </span><span class="NUMB">32</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">48</span><span class="PUNC">:</span><span class="STRN">"0"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">49</span><span class="PUNC">:</span><span class="STRN">"1"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">:</span><span class="STRN">"2"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">51</span><span class="PUNC">:</span><span class="STRN">"3"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">52</span><span class="PUNC">:</span><span class="STRN">"4"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">53</span><span class="PUNC">:</span><span class="STRN">"5"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">54</span><span class="PUNC">:</span><span class="STRN">"6"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">55</span><span class="PUNC">:</span><span class="STRN">"7"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>883</span>   </span><span class="NUMB">56</span><span class="PUNC">:</span><span class="STRN">"8"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">57</span><span class="PUNC">:</span><span class="STRN">"9"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">59</span><span class="PUNC">:</span><span class="STRN">";"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">61</span><span class="PUNC">:</span><span class="STRN">"="</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">65</span><span class="PUNC">:</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">66</span><span class="PUNC">:</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">67</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">68</span><span class="PUNC">:</span><span class="STRN">"d"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">69</span><span class="PUNC">:</span><span class="STRN">"e"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>884</span>   </span><span class="NUMB">70</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">71</span><span class="PUNC">:</span><span class="STRN">"g"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">72</span><span class="PUNC">:</span><span class="STRN">"h"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">73</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">74</span><span class="PUNC">:</span><span class="STRN">"j"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">75</span><span class="PUNC">:</span><span class="STRN">"k"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">76</span><span class="PUNC">:</span><span class="STRN">"l"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">77</span><span class="PUNC">:</span><span class="STRN">"m"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">78</span><span class="PUNC">:</span><span class="STRN">"n"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>885</span>   </span><span class="NUMB">79</span><span class="PUNC">:</span><span class="STRN">"o"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">80</span><span class="PUNC">:</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">81</span><span class="PUNC">:</span><span class="STRN">"q"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">82</span><span class="PUNC">:</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">83</span><span class="PUNC">:</span><span class="STRN">"s"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">84</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">85</span><span class="PUNC">:</span><span class="STRN">"u"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">86</span><span class="PUNC">:</span><span class="STRN">"v"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">87</span><span class="PUNC">:</span><span class="STRN">"w"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>886</span>   </span><span class="NUMB">88</span><span class="PUNC">:</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">89</span><span class="PUNC">:</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">90</span><span class="PUNC">:</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">107</span><span class="PUNC">:</span><span class="STRN">"+"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">109</span><span class="PUNC">:</span><span class="STRN">"-"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">110</span><span class="PUNC">:</span><span class="STRN">"."</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">188</span><span class="PUNC">:</span><span class="STRN">","</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">190</span><span class="PUNC">:</span><span class="STRN">"."</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>887</span>   </span><span class="NUMB">191</span><span class="PUNC">:</span><span class="STRN">"/"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">192</span><span class="PUNC">:</span><span class="STRN">"`"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">219</span><span class="PUNC">:</span><span class="STRN">"["</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">220</span><span class="PUNC">:</span><span class="STRN">"\\"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">221</span><span class="PUNC">:</span><span class="STRN">"]"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">222</span><span class="PUNC">:</span><span class="STRN">"\""</span><span class="WHIT">
<span class='line'>888</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>889</span> </span></pre></body></html>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">// Project:   SproutCore Costello - Property Observing Library</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="COMM">// Copyright: ©2006-2009 Sprout Systems, Inc. and contributors.</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="COMM">//            Portions ©2008-2009 Apple Inc. All rights reserved.</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="COMM">// License:   Licensed under MIT license (see license.js)</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  7</span> 
<span class='line'>  8</span> </span><span class="COMM">/*global NodeList */</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="COMM">// These commands are used by the build tools to control load order.  On the</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="COMM">// client side these are a no-op.</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">require</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">require</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">require</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sc_require</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sc_require</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">require</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sc_resource</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sc_resource</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">sc_resource</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'license'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 15</span> 
<span class='line'> 16</span> </span><span class="COMM">// ........................................</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="COMM">// GLOBAL CONSTANTS</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="COMM">// </span><span class="WHIT">
<span class='line'> 19</span> </span><span class="COMM">// Most global constants should be defined inside of the SC namespace.  </span><span class="WHIT">
<span class='line'> 20</span> </span><span class="COMM">// However the following two are useful enough and generally benign enough</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="COMM">// to put into the global object.</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'> 23</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 24</span> 
<span class='line'> 25</span> </span><span class="COMM">// prevent a console.log from blowing things up if we are on a browser that</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="COMM">// does not support it</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">console</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 28</span>   </span><span class="NAME">window.console</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 29</span>   </span><span class="NAME">console.log</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">console.info</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">console.error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 31</span> 
<span class='line'> 32</span> </span><span class="COMM">// ........................................</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="COMM">// BOOTSTRAP</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="COMM">// </span><span class="WHIT">
<span class='line'> 35</span> </span><span class="COMM">// The root namespace and some common utility methods are defined here. The</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="COMM">// rest of the methods go into the mixin defined below.</span><span class="WHIT">
<span class='line'> 37</span> 
<span class='line'> 38</span> </span><span class="COMM">/**
<span class='line'> 39</span>   @namespace
<span class='line'> 40</span>   
<span class='line'> 41</span>   The SproutCore namespace.  All SproutCore methods and functions are defined
<span class='line'> 42</span>   inside of this namespace.  You generally should not add new properties to
<span class='line'> 43</span>   this namespace as it may be overwritten by future versions of SproutCore.
<span class='line'> 44</span>   
<span class='line'> 45</span>   You can also use the shorthand "SC" instead of "SproutCore".
<span class='line'> 46</span>   
<span class='line'> 47</span>   SproutCore-Base is a framework that provides core functions for SproutCore
<span class='line'> 48</span>   including cross-platform functions, support for property observing and
<span class='line'> 49</span>   objects.  It's focus is on small size and performance.  You can use this 
<span class='line'> 50</span>   in place of or along-side other cross-platform libraries such as jQuery or
<span class='line'> 51</span>   Prototype.
<span class='line'> 52</span>   
<span class='line'> 53</span>   The core Base framework is based on the jQuery API with a number of 
<span class='line'> 54</span>   performance optimizations.
<span class='line'> 55</span> */</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">SC</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'> 57</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">SproutCore</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SproutCore</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">SC</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 58</span> 
<span class='line'> 59</span> </span><span class="COMM">/**
<span class='line'> 60</span>   @private
<span class='line'> 61</span> 
<span class='line'> 62</span>   Adds properties to a target object. You must specify whether
<span class='line'> 63</span>   to overwrite a value for a property or not.
<span class='line'> 64</span> 
<span class='line'> 65</span>   Used as a base function for the wrapper functions SC.mixin and SC.supplement.
<span class='line'> 66</span> 
<span class='line'> 67</span>   @param overwrite {Boolean} if a target has a value for a property, this specifies
<span class='line'> 68</span>                   whether or not to overwrite that value with the copyied object's 
<span class='line'> 69</span>                   property value.
<span class='line'> 70</span>   @param target {Object} the target object to extend
<span class='line'> 71</span>   @param properties {Object} one or more objects with properties to copy.
<span class='line'> 72</span>   @returns {Object} the target object.
<span class='line'> 73</span>   @static
<span class='line'> 74</span> */</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="NAME">SC._baseMixin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">override</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 76</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 77</span>   </span><span class="COMM">// copy reference to target object</span><span class="WHIT">
<span class='line'> 78</span>       </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 79</span>       </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 80</span>       </span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args.length</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 81</span>       </span><span class="NAME">options</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">copy</span><span class="WHIT"> </span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 82</span> 
<span class='line'> 83</span>   </span><span class="COMM">// Handle case where we have only one item...extend SC</span><span class="WHIT">
<span class='line'> 84</span>   </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 85</span>     </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span>     </span><span class="NAME">idx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 87</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 88</span> 
<span class='line'> 89</span>   </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">++</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 90</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 91</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 92</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 93</span>       </span><span class="NAME">copy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 94</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">===</span><span class="NAME">copy</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// prevent never-ending loop</span><span class="WHIT">
<span class='line'> 95</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">copy</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">override</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">copy</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 96</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 97</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 98</span>   
<span class='line'> 99</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>100</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> 
<span class='line'>102</span> </span><span class="COMM">/**
<span class='line'>103</span>   Adds properties to a target object.
<span class='line'>104</span>   
<span class='line'>105</span>   Takes the root object and adds the attributes for any additional 
<span class='line'>106</span>   arguments passed.
<span class='line'>107</span> 
<span class='line'>108</span>   @param target {Object} the target object to extend
<span class='line'>109</span>   @param properties {Object} one or more objects with properties to copy.
<span class='line'>110</span>   @returns {Object} the target object.
<span class='line'>111</span>   @static
<span class='line'>112</span> */</span><span class="WHIT">
<span class='line'>113</span> </span><span class="NAME">SC.mixin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>114</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span>   </span><span class="NAME">args.unshift</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>116</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC._baseMixin.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>117</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>118</span> 
<span class='line'>119</span> </span><span class="COMM">/**
<span class='line'>120</span>   Adds properties to a target object.  Unlike SC.mixin, however, if the target
<span class='line'>121</span>   already has a value for a property, it will not be overwritten.
<span class='line'>122</span>   
<span class='line'>123</span>   Takes the root object and adds the attributes for any additional 
<span class='line'>124</span>   arguments passed.
<span class='line'>125</span> 
<span class='line'>126</span>   @param target {Object} the target object to extend
<span class='line'>127</span>   @param properties {Object} one or more objects with properties to copy.
<span class='line'>128</span>   @returns {Object} the target object.
<span class='line'>129</span>   @static
<span class='line'>130</span> */</span><span class="WHIT">
<span class='line'>131</span> </span><span class="NAME">SC.supplement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>132</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>133</span>   </span><span class="NAME">args.unshift</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>134</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC._baseMixin.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>136</span> 
<span class='line'>137</span> </span><span class="COMM">/** 
<span class='line'>138</span>   Alternative to mixin.  Provided for compatibility with jQuery.
<span class='line'>139</span>   @function 
<span class='line'>140</span> */</span><span class="WHIT">
<span class='line'>141</span> </span><span class="NAME">SC.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.mixin</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>142</span> 
<span class='line'>143</span> </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>144</span> </span><span class="COMM">// CORE FUNCTIONS</span><span class="WHIT">
<span class='line'>145</span> </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>146</span> </span><span class="COMM">// Enough with the bootstrap code.  Let's define some core functions</span><span class="WHIT">
<span class='line'>147</span> 
<span class='line'>148</span> </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="COMM">/** @scope SC */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>149</span>   
<span class='line'>150</span>   </span><span class="COMM">// ........................................</span><span class="WHIT">
<span class='line'>151</span>   </span><span class="COMM">// GLOBAL CONSTANTS</span><span class="WHIT">
<span class='line'>152</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>153</span>   </span><span class="NAME">T_ERROR</span><span class="PUNC">:</span><span class="WHIT">     </span><span class="STRN">'error'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>154</span>   </span><span class="NAME">T_OBJECT</span><span class="PUNC">:</span><span class="WHIT">    </span><span class="STRN">'object'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>155</span>   </span><span class="NAME">T_NULL</span><span class="PUNC">:</span><span class="WHIT">      </span><span class="STRN">'null'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>156</span>   </span><span class="NAME">T_CLASS</span><span class="PUNC">:</span><span class="WHIT">     </span><span class="STRN">'class'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>157</span>   </span><span class="NAME">T_HASH</span><span class="PUNC">:</span><span class="WHIT">      </span><span class="STRN">'hash'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>158</span>   </span><span class="NAME">T_FUNCTION</span><span class="PUNC">:</span><span class="WHIT">  </span><span class="STRN">'function'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>159</span>   </span><span class="NAME">T_UNDEFINED</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>160</span>   </span><span class="NAME">T_NUMBER</span><span class="PUNC">:</span><span class="WHIT">    </span><span class="STRN">'number'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>161</span>   </span><span class="NAME">T_BOOL</span><span class="PUNC">:</span><span class="WHIT">      </span><span class="STRN">'boolean'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>162</span>   </span><span class="NAME">T_ARRAY</span><span class="PUNC">:</span><span class="WHIT">     </span><span class="STRN">'array'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>163</span>   </span><span class="NAME">T_STRING</span><span class="PUNC">:</span><span class="WHIT">    </span><span class="STRN">'string'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>164</span>   
<span class='line'>165</span>   </span><span class="COMM">// ........................................</span><span class="WHIT">
<span class='line'>166</span>   </span><span class="COMM">// TYPING & ARRAY MESSAGING</span><span class="WHIT">
<span class='line'>167</span>   </span><span class="COMM">//   </span><span class="WHIT">
<span class='line'>168</span> 
<span class='line'>169</span>   </span><span class="COMM">/**
<span class='line'>170</span>     Returns a consistant type for the passed item.
<span class='line'>171</span> 
<span class='line'>172</span>     Use this instead of the built-in typeOf() to get the type of an item. 
<span class='line'>173</span>     It will return the same result across all browsers and includes a bit 
<span class='line'>174</span>     more detail.  Here is what will be returned:
<span class='line'>175</span> 
<span class='line'>176</span>     | Return Value Constant | Meaning |
<span class='line'>177</span>     | SC.T_STRING | String primitive |
<span class='line'>178</span>     | SC.T_NUMBER | Number primitive |
<span class='line'>179</span>     | SC.T_BOOLEAN | Boolean primitive |
<span class='line'>180</span>     | SC.T_NULL | Null value |
<span class='line'>181</span>     | SC.T_UNDEFINED | Undefined value |
<span class='line'>182</span>     | SC.T_FUNCTION | A function |
<span class='line'>183</span>     | SC.T_ARRAY | An instance of Array |
<span class='line'>184</span>     | SC.T_CLASS | A SproutCore class (created using SC.Object.extend()) |
<span class='line'>185</span>     | SC.T_OBJECT | A SproutCore object instance |
<span class='line'>186</span>     | SC.T_HASH | A JavaScript object not inheriting from SC.Object |
<span class='line'>187</span> 
<span class='line'>188</span>     @param item {Object} the item to check
<span class='line'>189</span>     @returns {String} the type
<span class='line'>190</span>   */</span><span class="WHIT">  
<span class='line'>191</span>   </span><span class="NAME">typeOf</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>192</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.T_UNDEFINED</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>193</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.T_NULL</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>194</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>195</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>196</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>197</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.T_ARRAY</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>198</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>199</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.isClass</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">SC.T_CLASS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>200</span> 
<span class='line'>201</span>       </span><span class="COMM">// NB: typeOf() may be called before SC.Error has had a chance to load</span><span class="WHIT">
<span class='line'>202</span>       </span><span class="COMM">// so this code checks for the presence of SC.Error first just to make</span><span class="WHIT">
<span class='line'>203</span>       </span><span class="COMM">// sure.  No error instance can exist before the class loads anyway so</span><span class="WHIT">
<span class='line'>204</span>       </span><span class="COMM">// this is safe.</span><span class="WHIT">
<span class='line'>205</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.Error</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">SC.Error</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>206</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.T_ERROR</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">        
<span class='line'>207</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.isObject</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>208</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.T_OBJECT</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>209</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.T_HASH</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>210</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.isClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">SC.T_CLASS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>211</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>212</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>213</span> 
<span class='line'>214</span>   </span><span class="COMM">/**
<span class='line'>215</span>     Returns YES if the passed value is null or undefined.  This avoids errors
<span class='line'>216</span>     from JSLint complaining about use of ==, which can be technically 
<span class='line'>217</span>     confusing.
<span class='line'>218</span>     
<span class='line'>219</span>     @param {Object} obj value to test
<span class='line'>220</span>     @returns {Boolean}
<span class='line'>221</span>   */</span><span class="WHIT">
<span class='line'>222</span>   </span><span class="NAME">none</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>223</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">===</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">  
<span class='line'>224</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>225</span> 
<span class='line'>226</span>   </span><span class="COMM">/**
<span class='line'>227</span>     Verifies that a value is either null or an empty string.  Return false if
<span class='line'>228</span>     the object is not a string.
<span class='line'>229</span>     
<span class='line'>230</span>     @param {Object} obj value to test
<span class='line'>231</span>     @returns {Boolean}
<span class='line'>232</span>   */</span><span class="WHIT">
<span class='line'>233</span>   </span><span class="NAME">empty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>234</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">===</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">===</span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>235</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>236</span>   
<span class='line'>237</span>   </span><span class="COMM">/**
<span class='line'>238</span>     Returns YES if the passed object is an array or array-like. Instances
<span class='line'>239</span>     of the NodeList class return NO.
<span class='line'>240</span> 
<span class='line'>241</span>     Unlike SC.typeOf this method returns true even if the passed object is 
<span class='line'>242</span>     not formally array but appears to be array-like (i.e. has a length 
<span class='line'>243</span>     property, responds to .objectAt, etc.)
<span class='line'>244</span> 
<span class='line'>245</span>     @param obj {Object} the object to test
<span class='line'>246</span>     @returns {Boolean} 
<span class='line'>247</span>   */</span><span class="WHIT">
<span class='line'>248</span>   </span><span class="NAME">isArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>249</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">obj.objectAt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// fast path</span><span class="WHIT">
<span class='line'>250</span>     
<span class='line'>251</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">obj.length</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>252</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">obj.setInterval</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>253</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>254</span> 
<span class='line'>255</span>   </span><span class="COMM">/**
<span class='line'>256</span>     Makes an object into an Array if it is not array or array-like already.
<span class='line'>257</span>     Unlike SC.A(), this method will not clone the object if it is already
<span class='line'>258</span>     an array.
<span class='line'>259</span>     
<span class='line'>260</span>     @param {Object} obj object to convert
<span class='line'>261</span>     @returns {Array} Actual array
<span class='line'>262</span>   */</span><span class="WHIT">
<span class='line'>263</span>   </span><span class="NAME">makeArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>264</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.isArray</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.A</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>265</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>266</span>   
<span class='line'>267</span>   </span><span class="COMM">/**
<span class='line'>268</span>     Converts the passed object to an Array.  If the object appears to be 
<span class='line'>269</span>     array-like, a new array will be cloned from it.  Otherwise, a new array
<span class='line'>270</span>     will be created with the item itself as the only item in the array.
<span class='line'>271</span>     
<span class='line'>272</span>     @param object {Object} any enumerable or array-like object.
<span class='line'>273</span>     @returns {Array} Array of items
<span class='line'>274</span>   */</span><span class="WHIT">
<span class='line'>275</span>   </span><span class="NAME">A</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>276</span>     </span><span class="COMM">// null or undefined -- fast path</span><span class="WHIT">
<span class='line'>277</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>278</span>     
<span class='line'>279</span>     </span><span class="COMM">// primitive -- fast path</span><span class="WHIT">
<span class='line'>280</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.slice</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>281</span>       </span><span class="COMM">// do we have a string?</span><span class="WHIT">
<span class='line'>282</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>283</span>       </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>284</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>285</span>     
<span class='line'>286</span>     </span><span class="COMM">// enumerable -- fast path</span><span class="WHIT">
<span class='line'>287</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.toArray</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj.toArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span>     
<span class='line'>289</span>     </span><span class="COMM">// if not array-like, then just wrap in array.</span><span class="WHIT">
<span class='line'>290</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.isArray</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>291</span>     
<span class='line'>292</span>     </span><span class="COMM">// when all else fails, do a manual convert...</span><span class="WHIT">
<span class='line'>293</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">[</span><span class="NAME">len</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">len</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>295</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>296</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>297</span>   
<span class='line'>298</span>   </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>299</span>   </span><span class="COMM">// GUIDS & HASHES</span><span class="WHIT">
<span class='line'>300</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>301</span>   
<span class='line'>302</span>   </span><span class="NAME">guidKey</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"_sc_guid_"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>303</span> 
<span class='line'>304</span>   </span><span class="COMM">// Used for guid generation...</span><span class="WHIT">
<span class='line'>305</span>   </span><span class="NAME">_nextGUID</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_numberGuids</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_stringGuids</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_keyCache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>306</span> 
<span class='line'>307</span>   </span><span class="COMM">/**
<span class='line'>308</span>     Returns a unique GUID for the object.  If the object does not yet have
<span class='line'>309</span>     a guid, one will be assigned to it.  You can call this on any object,
<span class='line'>310</span>     SC.Object-based or not, but be aware that it will add a _guid property.
<span class='line'>311</span> 
<span class='line'>312</span>     You can also use this method on DOM Element objects.
<span class='line'>313</span> 
<span class='line'>314</span>     @param obj {Object} any object, string, number, Element, or primitive
<span class='line'>315</span>     @returns {String} the unique guid for this instance.
<span class='line'>316</span>   */</span><span class="WHIT">
<span class='line'>317</span>   </span><span class="NAME">guidFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>318</span>     
<span class='line'>319</span>     </span><span class="COMM">// special cases where we don't want to add a key to object</span><span class="WHIT">
<span class='line'>320</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"(undefined)"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>321</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'(null)'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>322</span> 
<span class='line'>323</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">guidKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.guidKey</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">guidKey</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">guidKey</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>325</span> 
<span class='line'>326</span>     </span><span class="COMM">// More special cases; not as common, so we check for them after the cache</span><span class="WHIT">
<span class='line'>327</span>     </span><span class="COMM">// lookup</span><span class="WHIT">
<span class='line'>328</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'(Object)'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>329</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'(Array)'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>330</span> 
<span class='line'>331</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cache</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>332</span> 
<span class='line'>333</span>     </span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>334</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_NUMBER</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>335</span>         </span><span class="NAME">cache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._numberGuids</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>336</span>         </span><span class="NAME">ret</span><span class="WHIT">   </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cache</span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>337</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>338</span>           </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"nu"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>339</span>           </span><span class="NAME">cache</span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>340</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>341</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>342</span> 
<span class='line'>343</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>344</span>         </span><span class="NAME">cache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._stringGuids</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>345</span>         </span><span class="NAME">ret</span><span class="WHIT">   </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cache</span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>346</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>347</span>           </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"st"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>348</span>           </span><span class="NAME">cache</span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>349</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>350</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> 
<span class='line'>352</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_BOOL</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>353</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"(true)"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"(false)"</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>354</span>       </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>355</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.generateGuid</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>356</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>357</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>358</span> 
<span class='line'>359</span>   </span><span class="COMM">/**
<span class='line'>360</span>     Returns a key name that combines the named key + prefix.  This is more 
<span class='line'>361</span>     efficient than simply combining strings because it uses a cache  
<span class='line'>362</span>     internally for performance.
<span class='line'>363</span>     
<span class='line'>364</span>     @param {String} prefix the prefix to attach to the key
<span class='line'>365</span>     @param {String} key key
<span class='line'>366</span>     @returns {String} result 
<span class='line'>367</span>   */</span><span class="WHIT">
<span class='line'>368</span>   </span><span class="NAME">keyFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prefix</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>369</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pcache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._keyCache</span><span class="PUNC">[</span><span class="NAME">prefix</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>370</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">pcache</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">pcache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._keyCache</span><span class="PUNC">[</span><span class="NAME">prefix</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// get cache for prefix</span><span class="WHIT">
<span class='line'>371</span>     </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pcache</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>372</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pcache</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prefix</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'_'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>373</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>374</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>375</span> 
<span class='line'>376</span>   </span><span class="COMM">/**
<span class='line'>377</span>     Generates a new guid, optionally saving the guid to the object that you
<span class='line'>378</span>     pass in.  You will rarely need to use this method.  Instead you should
<span class='line'>379</span>     call SC.guidFor(obj), which return an existing guid if available.
<span class='line'>380</span> 
<span class='line'>381</span>     @param {Object} obj the object to assign the guid to
<span class='line'>382</span>     @returns {String} the guid
<span class='line'>383</span>   */</span><span class="WHIT">
<span class='line'>384</span>   </span><span class="NAME">generateGuid</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>385</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">"sc"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._nextGUID</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>386</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">this.guidKey</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>387</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>388</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>389</span> 
<span class='line'>390</span>   </span><span class="COMM">/**
<span class='line'>391</span>     Returns a unique hash code for the object.  If the object implements
<span class='line'>392</span>     a hash() method, the value of that method will be returned.  Otherwise,
<span class='line'>393</span>     this will return the same value as guidFor().  
<span class='line'>394</span> 
<span class='line'>395</span>     Unlike guidFor(), this method allows you to implement logic in your 
<span class='line'>396</span>     code to cause two separate instances of the same object to be treated as
<span class='line'>397</span>     if they were equal for comparisons and other functions.
<span class='line'>398</span> 
<span class='line'>399</span>     IMPORTANT:  If you implement a hash() method, it MUST NOT return a 
<span class='line'>400</span>     number or a string that contains only a number.  Typically hash codes 
<span class='line'>401</span>     are strings that begin with a "%".
<span class='line'>402</span> 
<span class='line'>403</span>     @param obj {Object} the object
<span class='line'>404</span>     @returns {String} the hash code for this instance.
<span class='line'>405</span>   */</span><span class="WHIT">
<span class='line'>406</span>   </span><span class="NAME">hashFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>407</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hashFunc</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>408</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">hashFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj.hash</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">hashFunc</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">hashFunc.call</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.guidFor</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>409</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>410</span>     
<span class='line'>411</span>   </span><span class="COMM">/**
<span class='line'>412</span>     This will compare the two object values using their hash codes.
<span class='line'>413</span> 
<span class='line'>414</span>     @param a {Object} first value to compare
<span class='line'>415</span>     @param b {Object} the second value to compare
<span class='line'>416</span>     @returns {Boolean} YES if the two have equal hash code values.
<span class='line'>417</span> 
<span class='line'>418</span>   */</span><span class="WHIT">
<span class='line'>419</span>   </span><span class="NAME">isEqual</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>420</span>     </span><span class="COMM">// shortcut a few places.</span><span class="WHIT">
<span class='line'>421</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>422</span>       </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>423</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>424</span>       </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>425</span> 
<span class='line'>426</span>     </span><span class="COMM">// finally, check their hash-codes</span><span class="WHIT">
<span class='line'>427</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.hashFor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.hashFor</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>428</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>429</span>   
<span class='line'>430</span>   
<span class='line'>431</span>   </span><span class="COMM">/**
<span class='line'>432</span>    This will compare two javascript values of possibly different types.
<span class='line'>433</span>    It will tell you which one is greater than the other by returning
<span class='line'>434</span>    -1 if the first is smaller than the second,
<span class='line'>435</span>     0 if both are equal,
<span class='line'>436</span>     1 if the first is greater than the second.
<span class='line'>437</span>   
<span class='line'>438</span>    The order is calculated based on SC.ORDER_DEFINITION , if types are different.
<span class='line'>439</span>    In case they have the same type an appropriate comparison for this type is made.
<span class='line'>440</span> 
<span class='line'>441</span>    @param v {Object} first value to compare
<span class='line'>442</span>    @param w {Object} the second value to compare
<span class='line'>443</span>    @returns {NUMBER} -1 if v &lt; w, 0 if v = w and 1 if v > w.
<span class='line'>444</span> 
<span class='line'>445</span>   */</span><span class="WHIT">
<span class='line'>446</span>   </span><span class="NAME">compare</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>447</span>     </span><span class="COMM">// Doing a '===' check is very cheap, so in the case of equality, checking</span><span class="WHIT">
<span class='line'>448</span>     </span><span class="COMM">// this up-front is a big win.</span><span class="WHIT">
<span class='line'>449</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>450</span>     
<span class='line'>451</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type1</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>452</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type2</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span>     
<span class='line'>454</span>     </span><span class="COMM">// If we haven't yet generated a reverse-mapping of SC.ORDER_DEFINITION,</span><span class="WHIT">
<span class='line'>455</span>     </span><span class="COMM">// do so now.</span><span class="WHIT">
<span class='line'>456</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mapping</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.ORDER_DEFINITION_MAPPING</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>457</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">mapping</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>458</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">order</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.ORDER_DEFINITION</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>459</span>       </span><span class="NAME">mapping</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.ORDER_DEFINITION_MAPPING</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>460</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>461</span>       </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">order.length</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="PUNC">++</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>462</span>         </span><span class="NAME">mapping</span><span class="PUNC">[</span><span class="NAME">order</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>463</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>464</span>       
<span class='line'>465</span>       </span><span class="COMM">// We no longer need SC.ORDER_DEFINITION.</span><span class="WHIT">
<span class='line'>466</span>       </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">SC.ORDER_DEFINITION</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>467</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>468</span>     
<span class='line'>469</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type1Index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mapping</span><span class="PUNC">[</span><span class="NAME">type1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>470</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type2Index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mapping</span><span class="PUNC">[</span><span class="NAME">type2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>471</span>     
<span class='line'>472</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type1Index</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">type2Index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>473</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type1Index</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">type2Index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>474</span>     
<span class='line'>475</span>     </span><span class="COMM">// ok - types are equal - so we have to check values now</span><span class="WHIT">
<span class='line'>476</span>     </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>477</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_BOOL</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>478</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_NUMBER</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>479</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">&lt;</span><span class="NAME">w</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>480</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">></span><span class="NAME">w</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>481</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>482</span> 
<span class='line'>483</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>484</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">comp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">v.localeCompare</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>485</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">comp</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>486</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">comp</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>487</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>488</span> 
<span class='line'>489</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_ARRAY</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>490</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">vLen</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">v.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>491</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wLen</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">w.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>492</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">vLen</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">wLen</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>493</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>494</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>495</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments.callee</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>496</span>         </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">===</span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>497</span>           </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">thisFunc</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>498</span>           </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>499</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>500</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>501</span>       
<span class='line'>502</span>         </span><span class="COMM">// all elements are equal now</span><span class="WHIT">
<span class='line'>503</span>         </span><span class="COMM">// shorter array should be ordered first</span><span class="WHIT">
<span class='line'>504</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">vLen</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">wLen</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>505</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">vLen</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">wLen</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>506</span>         </span><span class="COMM">// arrays are equal now</span><span class="WHIT">
<span class='line'>507</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span>         
<span class='line'>509</span>       </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_OBJECT</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>510</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v.constructor.isComparable</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">v.constructor.compare</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>511</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>512</span> 
<span class='line'>513</span>       </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>514</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>515</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>516</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>517</span>   
<span class='line'>518</span>   </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>519</span>   </span><span class="COMM">// OBJECT MANAGEMENT</span><span class="WHIT">
<span class='line'>520</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>521</span>   
<span class='line'>522</span>   </span><span class="COMM">/** 
<span class='line'>523</span>     Empty function.  Useful for some operations. 
<span class='line'>524</span>     
<span class='line'>525</span>     @returns {Object}
<span class='line'>526</span>   */</span><span class="WHIT">
<span class='line'>527</span>   </span><span class="NAME">K</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>528</span> 
<span class='line'>529</span>   </span><span class="COMM">/** 
<span class='line'>530</span>     Empty array.  Useful for some optimizations.
<span class='line'>531</span>   
<span class='line'>532</span>     @property {Array}
<span class='line'>533</span>   */</span><span class="WHIT">
<span class='line'>534</span>   </span><span class="NAME">EMPTY_ARRAY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>535</span> 
<span class='line'>536</span>   </span><span class="COMM">/**
<span class='line'>537</span>     Empty hash.  Useful for some optimizations.
<span class='line'>538</span>   
<span class='line'>539</span>     @property {Hash}
<span class='line'>540</span>   */</span><span class="WHIT">
<span class='line'>541</span>   </span><span class="NAME">EMPTY_HASH</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>542</span> 
<span class='line'>543</span>   </span><span class="COMM">/**
<span class='line'>544</span>     Empty range. Useful for some optimizations.
<span class='line'>545</span>     
<span class='line'>546</span>     @property {Range}
<span class='line'>547</span>   */</span><span class="WHIT">
<span class='line'>548</span>   </span><span class="NAME">EMPTY_RANGE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">length</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>549</span>   
<span class='line'>550</span>   </span><span class="COMM">/**
<span class='line'>551</span>     Creates a new object with the passed object as its prototype.
<span class='line'>552</span> 
<span class='line'>553</span>     This method uses JavaScript's native inheritence method to create a new 
<span class='line'>554</span>     object.    
<span class='line'>555</span> 
<span class='line'>556</span>     You cannot use beget() to create new SC.Object-based objects, but you
<span class='line'>557</span>     can use it to beget Arrays, Hashes, Sets and objects you build yourself.
<span class='line'>558</span>     Note that when you beget() a new object, this method will also call the
<span class='line'>559</span>     didBeget() method on the object you passed in if it is defined.  You can
<span class='line'>560</span>     use this method to perform any other setup needed.
<span class='line'>561</span> 
<span class='line'>562</span>     In general, you will not use beget() often as SC.Object is much more 
<span class='line'>563</span>     useful, but for certain rare algorithms, this method can be very useful.
<span class='line'>564</span> 
<span class='line'>565</span>     For more information on using beget(), see the section on beget() in 
<span class='line'>566</span>     Crockford's JavaScript: The Good Parts.
<span class='line'>567</span> 
<span class='line'>568</span>     @param obj {Object} the object to beget
<span class='line'>569</span>     @returns {Object} the new object.
<span class='line'>570</span>   */</span><span class="WHIT">
<span class='line'>571</span>   </span><span class="NAME">beget</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>572</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>573</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">K</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.K</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">K.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>575</span>     </span><span class="NAME">K.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// avoid leaks</span><span class="WHIT">
<span class='line'>576</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj.didBeget</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj.didBeget</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>577</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>578</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>579</span> 
<span class='line'>580</span>   </span><span class="COMM">/**
<span class='line'>581</span>     Creates a clone of the passed object.  This function can take just about
<span class='line'>582</span>     any type of object and create a clone of it, including primitive values
<span class='line'>583</span>     (which are not actually cloned because they are immutable).
<span class='line'>584</span> 
<span class='line'>585</span>     If the passed object implements the clone() method, then this function
<span class='line'>586</span>     will simply call that method and return the result.
<span class='line'>587</span> 
<span class='line'>588</span>     @param object {Object} the object to clone
<span class='line'>589</span>     @returns {Object} the cloned object
<span class='line'>590</span>   */</span><span class="WHIT">
<span class='line'>591</span>   </span><span class="NAME">copy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>592</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>593</span>     
<span class='line'>594</span>     </span><span class="COMM">// fast path</span><span class="WHIT">
<span class='line'>595</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">object.isCopyable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">object.copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>596</span>     
<span class='line'>597</span>     </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>598</span>     </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_ARRAY</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>599</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object.clone</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">object.clone</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>600</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>601</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>602</span>       </span><span class="KEYW">break</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>603</span> 
<span class='line'>604</span>     </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_HASH</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>605</span>     </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">SC.T_OBJECT</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>606</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object.clone</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">object.clone</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>607</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>608</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>609</span>         </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>610</span>         </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>611</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>612</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>613</span> 
<span class='line'>614</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>615</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>616</span> 
<span class='line'>617</span>   </span><span class="COMM">/**
<span class='line'>618</span>     Returns a new object combining the values of all passed hashes.
<span class='line'>619</span> 
<span class='line'>620</span>     @param object {Object} one or more objects
<span class='line'>621</span>     @returns {Object} new Object
<span class='line'>622</span>   */</span><span class="WHIT">
<span class='line'>623</span>   </span><span class="NAME">merge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>624</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>625</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">idx</span><span class="PUNC">&lt;</span><span class="NAME">len</span><span class="PUNC">;</span><span class="NAME">idx</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>626</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>627</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>628</span> 
<span class='line'>629</span>   </span><span class="COMM">/**
<span class='line'>630</span>     Returns all of the keys defined on an object or hash.  This is useful
<span class='line'>631</span>     when inspecting objects for debugging.
<span class='line'>632</span> 
<span class='line'>633</span>     @param {Object} obj
<span class='line'>634</span>     @returns {Array} array of keys
<span class='line'>635</span>   */</span><span class="WHIT">
<span class='line'>636</span>   </span><span class="NAME">keys</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>637</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>638</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ret.push</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>639</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>640</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>641</span> 
<span class='line'>642</span>   </span><span class="COMM">/**
<span class='line'>643</span>     Convenience method to inspect an object.  This method will attempt to 
<span class='line'>644</span>     convert the object into a useful string description.
<span class='line'>645</span>   */</span><span class="WHIT">
<span class='line'>646</span>   </span><span class="NAME">inspect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>647</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>648</span>     </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>649</span>       </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>650</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'toString'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// ignore useless items</span><span class="WHIT">
<span class='line'>651</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"function() { ... }"</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>652</span>       </span><span class="NAME">ret.push</span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">": "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>653</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>654</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"{"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ret.join</span><span class="PUNC">(</span><span class="STRN">" , "</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"}"</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>655</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>656</span> 
<span class='line'>657</span>   </span><span class="COMM">/**
<span class='line'>658</span>     Returns a tuple containing the object and key for the specified property 
<span class='line'>659</span>     path.  If no object could be found to match the property path, then 
<span class='line'>660</span>     returns null.
<span class='line'>661</span> 
<span class='line'>662</span>     This is the standard method used throughout SproutCore to resolve property
<span class='line'>663</span>     paths.
<span class='line'>664</span> 
<span class='line'>665</span>     @param path {String} the property path
<span class='line'>666</span>     @param root {Object} optional parameter specifying the place to start
<span class='line'>667</span>     @returns {Array} array with [object, property] if found or null
<span class='line'>668</span>   */</span><span class="WHIT">
<span class='line'>669</span>   </span><span class="NAME">tupleForPropertyPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>670</span> 
<span class='line'>671</span>     </span><span class="COMM">// if the passed path is itself a tuple, return it</span><span class="WHIT">
<span class='line'>672</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>673</span> 
<span class='line'>674</span>     </span><span class="COMM">// find the key.  It is the last . or first *</span><span class="WHIT">
<span class='line'>675</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>676</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.indexOf</span><span class="PUNC">(</span><span class="STRN">'*'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>677</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">stopAt</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>678</span>     </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">stopAt</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">path.slice</span><span class="PUNC">(</span><span class="NAME">stopAt</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>679</span> 
<span class='line'>680</span>     </span><span class="COMM">// convert path to object.</span><span class="WHIT">
<span class='line'>681</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.objectForPropertyPath</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>682</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>683</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>684</span> 
<span class='line'>685</span>   </span><span class="COMM">/** 
<span class='line'>686</span>     Finds the object for the passed path or array of path components.  This is 
<span class='line'>687</span>     the standard method used in SproutCore to traverse object paths.
<span class='line'>688</span> 
<span class='line'>689</span>     @param path {String} the path
<span class='line'>690</span>     @param root {Object} optional root object.  window is used otherwise
<span class='line'>691</span>     @param stopAt {Integer} optional point to stop searching the path.
<span class='line'>692</span>     @returns {Object} the found object or undefined.
<span class='line'>693</span>   */</span><span class="WHIT">
<span class='line'>694</span>   </span><span class="NAME">objectForPropertyPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>695</span> 
<span class='line'>696</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">nextDotAt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>697</span> 
<span class='line'>698</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>699</span> 
<span class='line'>700</span>     </span><span class="COMM">// faster method for strings</span><span class="WHIT">
<span class='line'>701</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>702</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">stopAt</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.length</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span>       </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>704</span>       </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>705</span>         </span><span class="NAME">nextDotAt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.indexOf</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>706</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">nextDotAt</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nextDotAt</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">nextDotAt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span>         </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.slice</span><span class="PUNC">(</span><span class="NAME">loc</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">nextDotAt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>708</span>         </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">root.get</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">root.get</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>709</span>         </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">nextDotAt</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>710</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>711</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">stopAt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// hit a dead end. :(</span><span class="WHIT">
<span class='line'>712</span> 
<span class='line'>713</span>     </span><span class="COMM">// older method using an array</span><span class="WHIT">
<span class='line'>714</span>     </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>715</span> 
<span class='line'>716</span>       </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>717</span>       </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">max</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>718</span>         </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">[</span><span class="NAME">loc</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>719</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">root.get</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">root.get</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>720</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>721</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">max</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>722</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>723</span> 
<span class='line'>724</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>725</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>726</span>   
<span class='line'>727</span>   
<span class='line'>728</span>   </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>729</span>   </span><span class="COMM">// LOCALIZATION SUPPORT</span><span class="WHIT">
<span class='line'>730</span>   </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>731</span>   
<span class='line'>732</span>   </span><span class="COMM">/**
<span class='line'>733</span>     Known loc strings
<span class='line'>734</span>     
<span class='line'>735</span>     @property {Hash}
<span class='line'>736</span>   */</span><span class="WHIT">
<span class='line'>737</span>   </span><span class="NAME">STRINGS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>738</span>   
<span class='line'>739</span>   </span><span class="COMM">/**
<span class='line'>740</span>     This is a simplified handler for installing a bunch of strings.  This
<span class='line'>741</span>     ignores the language name and simply applies the passed strings hash.
<span class='line'>742</span>     
<span class='line'>743</span>     @param {String} lang the language the strings are for
<span class='line'>744</span>     @param {Hash} strings hash of strings
<span class='line'>745</span>     @returns {SC} receiver
<span class='line'>746</span>   */</span><span class="WHIT">
<span class='line'>747</span>   </span><span class="NAME">stringsFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">lang</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">strings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>748</span>     </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="NAME">SC.STRINGS</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">strings</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>749</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>750</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>751</span>   
<span class='line'>752</span>   
<span class='line'>753</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// end mixin</span><span class="WHIT">
<span class='line'>754</span> 
<span class='line'>755</span> </span><span class="COMM">/** @private Aliasn for SC.clone() */</span><span class="WHIT">
<span class='line'>756</span> </span><span class="NAME">SC.clone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.copy</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>757</span> 
<span class='line'>758</span> </span><span class="COMM">/** @private Alias for SC.A() */</span><span class="WHIT">
<span class='line'>759</span> </span><span class="NAME">SC.$A</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.A</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>760</span> 
<span class='line'>761</span> </span><span class="COMM">/** @private Provided for compatibility with old HTML templates. */</span><span class="WHIT">
<span class='line'>762</span> </span><span class="NAME">SC.didLoad</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.K</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>763</span> 
<span class='line'>764</span> </span><span class="COMM">/** @private Used by SC.compare */</span><span class="WHIT">
<span class='line'>765</span> </span><span class="NAME">SC.ORDER_DEFINITION</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT"> </span><span class="NAME">SC.T_ERROR</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>766</span>                         </span><span class="NAME">SC.T_UNDEFINED</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>767</span>                         </span><span class="NAME">SC.T_NULL</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>768</span>                         </span><span class="NAME">SC.T_BOOL</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>769</span>                         </span><span class="NAME">SC.T_NUMBER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>770</span>                         </span><span class="NAME">SC.T_STRING</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>771</span>                         </span><span class="NAME">SC.T_ARRAY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>772</span>                         </span><span class="NAME">SC.T_HASH</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>773</span>                         </span><span class="NAME">SC.T_OBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>774</span>                         </span><span class="NAME">SC.T_FUNCTION</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>775</span>                         </span><span class="NAME">SC.T_CLASS</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>776</span> 
<span class='line'>777</span> 
<span class='line'>778</span> </span><span class="COMM">// ........................................</span><span class="WHIT">
<span class='line'>779</span> </span><span class="COMM">// FUNCTION ENHANCEMENTS</span><span class="WHIT">
<span class='line'>780</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>781</span> 
<span class='line'>782</span> </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="NAME">Function.prototype</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='line'>783</span> </span><span class="COMM">/** @lends Function.prototype */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>784</span>   
<span class='line'>785</span>   </span><span class="COMM">/**
<span class='line'>786</span>     Indicates that the function should be treated as a computed property.
<span class='line'>787</span>     
<span class='line'>788</span>     Computed properties are methods that you want to treat as if they were
<span class='line'>789</span>     static properties.  When you use get() or set() on a computed property,
<span class='line'>790</span>     the object will call the property method and return its value instead of 
<span class='line'>791</span>     returning the method itself.  This makes it easy to create "virtual 
<span class='line'>792</span>     properties" that are computed dynamically from other properties.
<span class='line'>793</span>     
<span class='line'>794</span>     Consider the following example:
<span class='line'>795</span>     
<span class='line'>796</span>     {{{
<span class='line'>797</span>       contact = SC.Object.create({
<span class='line'>798</span> 
<span class='line'>799</span>         firstName: "Charles",
<span class='line'>800</span>         lastName: "Jolley",
<span class='line'>801</span>         
<span class='line'>802</span>         // This is a computed property!
<span class='line'>803</span>         fullName: function() {
<span class='line'>804</span>           return this.getEach('firstName','lastName').compact().join(' ') ;
<span class='line'>805</span>         }.property('firstName', 'lastName'),
<span class='line'>806</span>         
<span class='line'>807</span>         // this is not
<span class='line'>808</span>         getFullName: function() {
<span class='line'>809</span>           return this.getEach('firstName','lastName').compact().join(' ') ;
<span class='line'>810</span>         }
<span class='line'>811</span>       });
<span class='line'>812</span> 
<span class='line'>813</span>       contact.get('firstName') ;
<span class='line'>814</span>       --> "Charles"
<span class='line'>815</span>       
<span class='line'>816</span>       contact.get('fullName') ;
<span class='line'>817</span>       --> "Charles Jolley"
<span class='line'>818</span>       
<span class='line'>819</span>       contact.get('getFullName') ;
<span class='line'>820</span>       --> function()
<span class='line'>821</span>     }}}
<span class='line'>822</span>     
<span class='line'>823</span>     Note that when you get the fullName property, SproutCore will call the
<span class='line'>824</span>     fullName() function and return its value whereas when you get() a property
<span class='line'>825</span>     that contains a regular method (such as getFullName above), then the 
<span class='line'>826</span>     function itself will be returned instead.
<span class='line'>827</span>     
<span class='line'>828</span>     h2. Using Dependent Keys
<span class='line'>829</span> 
<span class='line'>830</span>     Computed properties are often computed dynamically from other member 
<span class='line'>831</span>     properties.  Whenever those properties change, you need to notify any
<span class='line'>832</span>     object that is observing the computed property that the computed property
<span class='line'>833</span>     has changed also.  We call these properties the computed property is based
<span class='line'>834</span>     upon "dependent keys".
<span class='line'>835</span>     
<span class='line'>836</span>     For example, in the contact object above, the fullName property depends on
<span class='line'>837</span>     the firstName and lastName property.  If either property value changes,
<span class='line'>838</span>     any observer watching the fullName property will need to be notified as 
<span class='line'>839</span>     well.
<span class='line'>840</span>     
<span class='line'>841</span>     You inform SproutCore of these dependent keys by passing the key names
<span class='line'>842</span>     as parameters to the property() function.  Whenever the value of any key
<span class='line'>843</span>     you name here changes, the computed property will be marked as changed
<span class='line'>844</span>     also.
<span class='line'>845</span>     
<span class='line'>846</span>     You should always register dependent keys for computed properties to 
<span class='line'>847</span>     ensure they update.
<span class='line'>848</span>     
<span class='line'>849</span>     h2. Using Computed Properties as Setters
<span class='line'>850</span>     
<span class='line'>851</span>     Computed properties can be used to modify the state of an object as well
<span class='line'>852</span>     as to return a value.  Unlike many other key-value system, you use the 
<span class='line'>853</span>     same method to both get and set values on a computed property.  To 
<span class='line'>854</span>     write a setter, simply declare two extra parameters: key and value.
<span class='line'>855</span>     
<span class='line'>856</span>     Whenever your property function is called as a setter, the value 
<span class='line'>857</span>     parameter will be set.  Whenever your property is called as a getter the
<span class='line'>858</span>     value parameter will be undefined.
<span class='line'>859</span>     
<span class='line'>860</span>     For example, the following object will split any full name that you set
<span class='line'>861</span>     into a first name and last name components and save them.
<span class='line'>862</span>     
<span class='line'>863</span>     {{{
<span class='line'>864</span>       contact = SC.Object.create({
<span class='line'>865</span>         
<span class='line'>866</span>         fullName: function(key, value) {
<span class='line'>867</span>           if (value !== undefined) {
<span class='line'>868</span>             var parts = value.split(' ') ;
<span class='line'>869</span>             this.beginPropertyChanges()
<span class='line'>870</span>               .set('firstName', parts[0])
<span class='line'>871</span>               .set('lastName', parts[1])
<span class='line'>872</span>             .endPropertyChanges() ;
<span class='line'>873</span>           }
<span class='line'>874</span>           return this.getEach('firstName', 'lastName').compact().join(' ');
<span class='line'>875</span>         }.property('firstName','lastName')
<span class='line'>876</span>         
<span class='line'>877</span>       }) ;
<span class='line'>878</span>       
<span class='line'>879</span>     }}}
<span class='line'>880</span>     
<span class='line'>881</span>     h2. Why Use The Same Method for Getters and Setters?
<span class='line'>882</span>     
<span class='line'>883</span>     Most property-based frameworks expect you to write two methods for each
<span class='line'>884</span>     property but SproutCore only uses one. We do this because most of the time
<span class='line'>885</span>     when you write a setter is is basically a getter plus some extra work.
<span class='line'>886</span>     There is little added benefit in writing both methods when you can
<span class='line'>887</span>     conditionally exclude part of it. This helps to keep your code more
<span class='line'>888</span>     compact and easier to maintain.
<span class='line'>889</span>     
<span class='line'>890</span>     @param dependentKeys {String...} optional set of dependent keys
<span class='line'>891</span>     @returns {Function} the declared function instance
<span class='line'>892</span>   */</span><span class="WHIT">
<span class='line'>893</span>   </span><span class="NAME">property</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>894</span>     </span><span class="NAME">this.dependentKeys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.$A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>895</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">guid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>896</span>     </span><span class="NAME">this.cacheKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"__cache__"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">guid</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>897</span>     </span><span class="NAME">this.lastSetValueKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"__lastValue__"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">guid</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>898</span>     </span><span class="NAME">this.isProperty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>899</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>900</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>901</span>   
<span class='line'>902</span>   </span><span class="COMM">/**
<span class='line'>903</span>     You can call this method on a computed property to indicate that the 
<span class='line'>904</span>     property is cacheable (or not cacheable).  By default all computed 
<span class='line'>905</span>     properties are not cached.  Enabling this feature will allow SproutCore
<span class='line'>906</span>     to cache the return value of your computed property and to use that
<span class='line'>907</span>     value until one of your dependent properties changes or until you 
<span class='line'>908</span>     invoke propertyDidChange() and name the computed property itself.
<span class='line'>909</span>     
<span class='line'>910</span>     If you do not specify this option, computed properties are assumed to be
<span class='line'>911</span>     not cacheable.
<span class='line'>912</span>     
<span class='line'>913</span>     @param {Boolean} aFlag optionally indicate cacheable or no, default YES
<span class='line'>914</span>     @returns {Function} reciever
<span class='line'>915</span>   */</span><span class="WHIT">
<span class='line'>916</span>   </span><span class="NAME">cacheable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFlag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>917</span>     </span><span class="NAME">this.isProperty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">// also make a property just in case</span><span class="WHIT">
<span class='line'>918</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.dependentKeys</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.dependentKeys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>919</span>     </span><span class="NAME">this.isCacheable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">aFlag</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFlag</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>920</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>921</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>922</span>   
<span class='line'>923</span>   </span><span class="COMM">/**
<span class='line'>924</span>     Indicates that the computed property is volatile.  Normally SproutCore 
<span class='line'>925</span>     assumes that your computed property is idempotent.  That is, calling 
<span class='line'>926</span>     set() on your property more than once with the same value has the same
<span class='line'>927</span>     effect as calling it only once.  
<span class='line'>928</span>     
<span class='line'>929</span>     All non-computed properties are idempotent and normally you should make
<span class='line'>930</span>     your computed properties behave the same way.  However, if you need to
<span class='line'>931</span>     make your property change its return value everytime your method is
<span class='line'>932</span>     called, you may chain this to your property to make it volatile.
<span class='line'>933</span>     
<span class='line'>934</span>     If you do not specify this option, properties are assumed to be 
<span class='line'>935</span>     non-volatile. 
<span class='line'>936</span>     
<span class='line'>937</span>     @param {Boolean} aFlag optionally indicate state, default to YES
<span class='line'>938</span>     @returns {Function} receiver
<span class='line'>939</span>   */</span><span class="WHIT">
<span class='line'>940</span>   </span><span class="NAME">idempotent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFlag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>941</span>     </span><span class="NAME">this.isProperty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">// also make a property just in case</span><span class="WHIT">
<span class='line'>942</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.dependentKeys</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.dependentKeys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>943</span>     </span><span class="NAME">this.isVolatile</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">aFlag</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFlag</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>944</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>945</span>   </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>946</span>   
<span class='line'>947</span>   </span><span class="COMM">/**
<span class='line'>948</span>     Declare that a function should observe an object at the named path.  Note
<span class='line'>949</span>     that the path is used only to construct the observation one time.
<span class='line'>950</span>     
<span class='line'>951</span>     @returns {Function} receiver
<span class='line'>952</span>   */</span><span class="WHIT">
<span class='line'>953</span>   </span><span class="NAME">observes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">propertyPaths</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>954</span>     </span><span class="COMM">// sort property paths into local paths (i.e just a property name) and</span><span class="WHIT">
<span class='line'>955</span>     </span><span class="COMM">// full paths (i.e. those with a . or * in them)</span><span class="WHIT">
<span class='line'>956</span>     </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">local</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">paths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>957</span>     </span><span class="KEYW">while</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>958</span>       </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">loc</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>959</span>       </span><span class="COMM">// local</span><span class="WHIT">
<span class='line'>960</span>       </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">path.indexOf</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path.indexOf</span><span class="PUNC">(</span><span class="STRN">'*'</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>961</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">local</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">local</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.localPropertyPaths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>962</span>         </span><span class="NAME">local.push</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>963</span>         
<span class='line'>964</span>       </span><span class="COMM">// regular</span><span class="WHIT">
<span class='line'>965</span>       </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>966</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">paths</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">paths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.propertyPaths</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>967</span>         </span><span class="NAME">paths.push</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>968</span>       </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>969</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>970</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>971</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>972</span>   
<span class='line'>973</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>974</span> 
<span class='line'>975</span> </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>976</span> </span><span class="COMM">// STRING ENHANCEMENT</span><span class="WHIT">
<span class='line'>977</span> </span><span class="COMM">// </span><span class="WHIT">
<span class='line'>978</span> 
<span class='line'>979</span> </span><span class="COMM">// Interpolate string. looks for %@ or %@1; to control the order of params.</span><span class="WHIT">
<span class='line'>980</span> </span><span class="COMM">/**
<span class='line'>981</span>   Apply formatting options to the string.  This will look for occurrences
<span class='line'>982</span>   of %@ in your string and substitute them with the arguments you pass into
<span class='line'>983</span>   this method.  If you want to control the specific order of replacement, 
<span class='line'>984</span>   you can add a number after the key as well to indicate which argument 
<span class='line'>985</span>   you want to insert.  
<span class='line'>986</span> 
<span class='line'>987</span>   Ordered insertions are most useful when building loc strings where values
<span class='line'>988</span>   you need to insert may appear in different orders.
<span class='line'>989</span> 
<span class='line'>990</span>   h3. Examples
<span class='line'>991</span>   
<span class='line'>992</span>   {{{
<span class='line'>993</span>     "Hello %@ %@".fmt('John', 'Doe') => "Hello John Doe"
<span class='line'>994</span>     "Hello %@2, %@1".fmt('John', 'Doe') => "Hello Doe, John"
<span class='line'>995</span>   }}}
<span class='line'>996</span>   
<span class='line'>997</span>   @param args {Object...} optional arguments
<span class='line'>998</span>   @returns {String} formatted string
<span class='line'>999</span> */</span><span class="WHIT">
<span class='line'>1000</span> </span><span class="NAME">String.prototype.fmt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1001</span>   </span><span class="COMM">// first, replace any ORDERED replacements.</span><span class="WHIT">
<span class='line'>1002</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1003</span>       </span><span class="NAME">idx</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// the current index for non-numerical replacements</span><span class="WHIT">
<span class='line'>1004</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.replace</span><span class="PUNC">(</span><span class="REGX">/%@([0-9]+)?/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">argIndex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1005</span>     </span><span class="NAME">argIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">argIndex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">argIndex</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">++</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1006</span>     </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">argIndex</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1007</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">===</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'(null)'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>1008</span>   </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1009</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1010</span> 
<span class='line'>1011</span> </span><span class="COMM">/**
<span class='line'>1012</span>   Localizes the string.  This will look up the reciever string as a key 
<span class='line'>1013</span>   in the current Strings hash.  If the key matches, the loc'd value will be
<span class='line'>1014</span>   used.  The resulting string will also be passed through fmt() to insert
<span class='line'>1015</span>   any variables.
<span class='line'>1016</span>   
<span class='line'>1017</span>   @param args {Object...} optional arguments to interpolate also
<span class='line'>1018</span>   @returns {String} the localized and formatted string.
<span class='line'>1019</span> */</span><span class="WHIT">
<span class='line'>1020</span> </span><span class="NAME">String.prototype.loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1021</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.STRINGS</span><span class="PUNC">[</span><span class="KEYW">this</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1022</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">str.fmt.apply</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1023</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1024</span> 
<span class='line'>1025</span> 
<span class='line'>1026</span>   
<span class='line'>1027</span> </span><span class="COMM">/**
<span class='line'>1028</span>   Splits the string into words, separated by spaces. Empty strings are
<span class='line'>1029</span>   removed from the results.
<span class='line'>1030</span>   
<span class='line'>1031</span>   @returns {Array} an array of non-empty strings
<span class='line'>1032</span> */</span><span class="WHIT">
<span class='line'>1033</span> </span><span class="NAME">String.prototype.w</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>1034</span>   </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ary</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ary2</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ary2.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1035</span>   </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">&lt;</span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1036</span>     </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ary2</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1037</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">str.length</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">ary.push</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// skip empty strings</span><span class="WHIT">
<span class='line'>1038</span>   </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1039</span>   </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ary</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1040</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1041</span> 
<span class='line'>1042</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1043</span> </span><span class="COMM">// DATE ENHANCEMENT</span><span class="WHIT">
<span class='line'>1044</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1045</span> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">Date.now</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1046</span>   </span><span class="NAME">Date.now</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1047</span>     </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1048</span>   </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1049</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1050</span>   
<span class='line'>1051</span> </span></pre></body></html>